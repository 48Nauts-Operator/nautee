<!-- Auto-generated by Claude on 2025-06-08 03:24 -->

# Changelog Generator Documentation

## Overview

The **Changelog Generator** is a Python utility that automatically creates formatted changelog documentation by analyzing recent Git commit messages. It leverages Anthropic's Claude AI to intelligently summarize and categorize commits into readable release notes.

## Purpose

This tool automates the tedious process of manually writing changelogs by:
- Fetching recent Git commit messages from the repository
- Using AI to summarize and categorize the commits
- Generating a properly formatted Markdown changelog file
- Saving the output to `docs/changelog.md` with timestamp information

## Dependencies

```python
import os
import anthropic
from dotenv import load_dotenv
from datetime import datetime
import subprocess
```

### Required Packages
- `anthropic` - For Claude AI API integration
- `python-dotenv` - For environment variable management

## Core Functions

### `get_git_log(n=20)`

Retrieves recent Git commit messages using subprocess.

**Parameters:**
- `n` (int, optional): Number of recent commits to fetch. Default is 20.

**Returns:**
- `str`: Formatted commit messages as bullet points, or error message if Git command fails.

**Example output:**
```
* Add user authentication feature
* Fix database connection timeout
* Update documentation
```

### `format_prompt(git_log: str)`

Creates a structured prompt for the Claude AI model to process commit messages.

**Parameters:**
- `git_log` (str): Raw Git log output from `get_git_log()`

**Returns:**
- `str`: Formatted prompt with instructions for AI summarization

### `main()`

The primary function that orchestrates the changelog generation process:

1. **Environment Setup**: Loads environment variables and initializes Anthropic client
2. **Data Collection**: Fetches Git commit messages
3. **AI Processing**: Sends commits to Claude for summarization
4. **File Generation**: Creates formatted changelog with timestamp
5. **Output**: Saves to `docs/changelog.md`

## Configuration

### Environment Variables

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_anthropic_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514
```

**Required:**
- `ANTHROPIC_API_KEY`: Your Anthropic API key for Claude access

**Optional:**
- `ANTHROPIC_MODEL`: Claude model version (defaults to `claude-sonnet-4-20250514`)

## Usage

### Command Line
```bash
python changelog_generator.py
```

### Programmatic Usage
```python
from changelog_generator import main
main()
```

## Output Format

The generated changelog follows this structure:

```markdown
# üìù Changelog

_Last updated: 2024-01-15 14:30_

## Features
- New user authentication system
- Added API rate limiting

## Fixes  
- Resolved database connection issues
- Fixed memory leak in background tasks

## Improvements
- Enhanced error handling
- Updated documentation
```

## Prerequisites

- **Git Repository**: Must be run within a Git repository
- **API Access**: Valid Anthropic API key
- **Directory Structure**: `docs/` directory should exist for output

## Error Handling

- **Git Errors**: If Git commands fail, returns "# No commits found"
- **API Errors**: Anthropic client errors will propagate and should be handled by the caller
- **File Errors**: File writing errors are not explicitly handled

## Suggestions for Improvement

### Error Handling
```python
try:
    os.makedirs("docs", exist_ok=True)  # Ensure docs directory exists
except Exception as e:
    print(f"‚ùå Error creating docs directory: {e}")
```

### Configuration Validation
```python
if not os.getenv("ANTHROPIC_API_KEY"):
    raise ValueError("ANTHROPIC_API_KEY environment variable is required")
```

### Flexible Output Location
```python
output_path = os.getenv("CHANGELOG_PATH", "docs/changelog.md")
```

## Notes

- The tool fetches the last 20 commits by default - adjust based on your release cycle
- Claude's output quality depends on commit message quality
- Consider running this as part of your CI/CD pipeline before releases
- The generated changelog overwrites the existing file completely