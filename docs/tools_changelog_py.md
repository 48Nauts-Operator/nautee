<!-- Auto-generated by Claude on 2025-05-31 21:34 -->

# Changelog Generator Documentation

## Overview

The **Changelog Generator** is a Python utility that automatically creates formatted changelogs from Git commit history. It leverages Anthropic's Claude AI to analyze recent commit messages and generate organized, human-readable release notes in Markdown format.

## Purpose

- **Automate changelog generation** from Git commit messages
- **Generate structured release notes** using AI-powered summarization
- **Save time** by eliminating manual changelog writing
- **Maintain consistent documentation** across releases

## Dependencies

```bash
pip install anthropic python-dotenv
```

### Required Environment Variables

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_anthropic_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
```

## Functions

### `get_git_log(n=20)`

Retrieves recent Git commit messages using the `git log` command.

**Parameters:**
- `n` (int, optional): Number of recent commits to fetch. Defaults to 20.

**Returns:**
- `str`: Formatted commit messages or error message

**Example output:**
```
* Add user authentication feature
* Fix database connection timeout
* Update documentation
```

### `format_prompt(git_log: str)`

Creates a structured prompt for the Claude AI model to generate changelog summaries.

**Parameters:**
- `git_log` (str): Raw Git commit log output

**Returns:**
- `str`: Formatted prompt with instructions for AI summarization

### `main()`

The main execution function that orchestrates the changelog generation process:

1. Loads environment variables
2. Initializes Anthropic client
3. Fetches Git commit history
4. Generates AI-powered summary
5. Writes formatted changelog to file

## Output

The script generates a changelog file at `docs/changelog.md` with the following structure:

```markdown
# üìù Changelog

_Last updated: 2024-01-15 14:30_

## Features
- Added user authentication system
- Implemented data export functionality

## Fixes
- Resolved database connection issues
- Fixed UI rendering bugs

## Improvements
- Enhanced error handling
- Updated documentation
```

## Usage

### Basic Usage

```bash
python changelog_generator.py
```

### Integration Examples

**In a CI/CD pipeline:**
```yaml
- name: Generate Changelog
  run: python scripts/changelog_generator.py
```

**As a pre-release hook:**
```bash
#!/bin/bash
python changelog_generator.py
git add docs/changelog.md
git commit -m "Update changelog"
```

## Configuration Notes

### Model Selection
- Default model: `claude-sonnet-4-20250514`
- Override via `ANTHROPIC_MODEL` environment variable
- Supports other Claude models (check Anthropic documentation for available options)

### Customization Options
- **Commit count**: Modify the `n` parameter in `get_git_log()`
- **Output path**: Change `output_path` variable in `main()`
- **Prompt format**: Customize the prompt in `format_prompt()` for different changelog styles

## Error Handling

- **Git errors**: Gracefully handles cases where Git is unavailable or repository is invalid
- **API errors**: Anthropic client will raise exceptions for authentication or API issues
- **File errors**: May fail silently if `docs/` directory doesn't exist

## Suggestions for Improvement

### 1. Enhanced Error Handling
```python
def main():
    try:
        # Ensure docs directory exists
        os.makedirs("docs", exist_ok=True)
        
        # Validate API key exists
        if not os.getenv("ANTHROPIC_API_KEY"):
            raise ValueError("ANTHROPIC_API_KEY not found in environment")
            
    except Exception as e:
        print(f"‚ùå Error: {e}")
        exit(1)
```

### 2. Configuration File Support
Consider adding support for a `config.yaml` file:
```yaml
changelog:
  commits_count: 25
  output_path: "CHANGELOG.md"
  model: "claude-sonnet-4-20250514"
```

### 3. Date Range Filtering
Add support for generating changelogs for specific date ranges:
```python
def get_git_log_since(since_date: str):
    """Fetch commits since a specific date."""
    return subprocess.check_output([
        "git", "log", f"--since={since_date}", "--pretty=format:* %s"
    ]).decode()
```

### 4. Multiple Output Formats
Support different output formats (JSON, HTML, etc.) based on command-line arguments.

## Security Considerations

- **API Key Protection**: Ensure `.env` file is added to `.gitignore`
- **Command Injection**: Current implementation is safe, but be cautious when modifying Git commands
- **File Permissions**: Consider setting appropriate permissions on generated changelog files