<!--
This documentation was auto-generated by Claude on 2025-05-31T15-24-48.
Source file: ./tools/changelog.py
-->

# Git Changelog Generator

A Python script that automatically generates professional release notes from Git commit history using the Anthropic Claude API.

## Overview

This tool extracts recent commit messages from a Git repository and uses AI to transform them into well-formatted, readable changelog entries organized by categories such as Features, Fixes, and Improvements.

## Features

- Extracts Git commit history automatically
- AI-powered commit message summarization
- Organized changelog with categorical sections
- Timestamped output files
- Environment-based configuration
- Error handling for Git operations

## Prerequisites

- Python 3.6+
- Git repository (script must be run from within a Git repo)
- Anthropic API key

## Dependencies

```python
anthropic
python-dotenv
```

Install dependencies:
```bash
pip install anthropic python-dotenv
```

## Configuration

### Environment Variables

Create a `.env` file in the project root with the following variables:

```env
ANTHROPIC_API_KEY=your_anthropic_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to claude-sonnet-4-20250514
```

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `ANTHROPIC_API_KEY` | Yes | - | Your Anthropic API key for Claude access |
| `ANTHROPIC_MODEL` | No | `claude-sonnet-4-20250514` | Claude model to use for generation |

## Usage

1. Navigate to your Git repository directory
2. Ensure your `.env` file is configured
3. Run the script:

```bash
python changelog_generator.py
```

The script will:
1. Extract the last 10 commit messages
2. Send them to Claude for summarization
3. Generate formatted release notes
4. Save the output to `output/changelog_YYYY-MM-DDTHH-MM-SS.txt`

## Output

### File Location
Generated changelogs are saved to:
```
output/changelog_YYYY-MM-DDTHH-MM-SS.txt
```

### Sample Output Format
```markdown
# Release Notes

## Features
- Added user authentication system
- Implemented dashboard analytics

## Fixes
- Fixed login redirect issue
- Resolved database connection timeout

## Improvements
- Enhanced error handling
- Optimized query performance
```

## Error Handling

The script includes robust error handling:

- **Git Operations**: If Git commands fail (e.g., not in a Git repo), the script continues with a fallback message
- **API Errors**: Anthropic API errors will be raised and should be handled by the calling environment
- **File Operations**: Directory creation is handled safely with `exist_ok=True`

## Customization

### Commit Count
Modify the number of commits to analyze by changing the `-n` parameter:
```python
git_log = subprocess.check_output([
    "git", "log", "--pretty=format:* %s", "-n", "20"  # Changed from 10 to 20
]).decode()
```

### Prompt Customization
Modify the `prompt` variable to change how the AI processes commits:
```python
prompt = f"""Custom instructions for changelog generation...
Commits:
{git_log}
"""
```

### Output Format
Change the output file format or location:
```python
out_path = f"releases/changelog_{timestamp}.md"  # Save as Markdown
```

## API Usage

The script uses the Anthropic Messages API with the following parameters:

- **Model**: Configurable via environment variable
- **Max Tokens**: 1000 (sufficient for typical changelogs)
- **Role**: User role for single-turn conversation

## Limitations

- Requires active internet connection for API calls
- Limited to repositories with Git history
- API rate limits apply based on your Anthropic plan
- Commit message quality affects output quality

## Security Notes

- Store API keys securely in environment variables
- Never commit `.env` files to version control
- Consider using API key rotation for production use

## Troubleshooting

### Common Issues

1. **"Error reading git log"**: Ensure you're running the script from within a Git repository
2. **API Authentication Error**: Verify your `ANTHROPIC_API_KEY` is correct and active
3. **Permission Denied**: Check write permissions for the `output` directory
4. **Module Not Found**: Install required dependencies with `pip install`