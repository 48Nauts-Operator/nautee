<!--
This documentation was auto-generated by Claude on 2025-05-31T15-52-42.
Source file: ./tools/changelog.py
-->

# Git Changelog Generator

A Python utility that automatically generates professional changelog documentation from Git commit messages using the Anthropic Claude API.

## Overview

This tool extracts recent Git commit messages from your repository and uses AI to transform them into well-structured, readable release notes with proper categorization and formatting.

## Features

- Extracts commit messages from Git repository
- AI-powered changelog generation using Anthropic Claude
- Automatic categorization (Features, Fixes, Improvements)
- Markdown-formatted output
- Timestamped file generation
- Error handling for Git operations

## Prerequisites

- Python 3.6+
- Git repository (initialized and with commit history)
- Anthropic API key

## Dependencies

```python
anthropic>=0.3.0
python-dotenv>=0.19.0
```

Install dependencies:
```bash
pip install anthropic python-dotenv
```

## Configuration

### Environment Variables

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_anthropic_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to claude-sonnet-4-20250514
```

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `ANTHROPIC_API_KEY` | Yes | - | Your Anthropic API key for Claude access |
| `ANTHROPIC_MODEL` | No | `claude-sonnet-4-20250514` | Claude model version to use |

## Usage

### Basic Usage

Run the script from your Git repository root:

```bash
python changelog_generator.py
```

### Output

The tool generates:
- A timestamped changelog file in the `output/` directory
- Format: `output/changelog_YYYY-MM-DDTHH-MM-SS.txt`
- Console confirmation with file path

### Example Output Structure

```markdown
# Release Notes

## Features
- Added user authentication system
- Implemented dashboard analytics

## Fixes  
- Fixed login validation bug
- Resolved database connection timeout

## Improvements
- Enhanced error handling
- Updated documentation
```

## Code Structure

### Main Components

#### 1. Environment Setup
```python
load_dotenv()
client = anthropic.Anthropic(api_key=os.getenv("ANTHROPIC_API_KEY"))
model = os.getenv("ANTHROPIC_MODEL", "claude-sonnet-4-20250514")
```

#### 2. Git Log Extraction
```python
git_log = subprocess.check_output([
    "git", "log", "--pretty=format:* %s", "-n", "10"
]).decode()
```

#### 3. AI Processing
```python
response = client.messages.create(
    model=model,
    max_tokens=1000,
    messages=[{"role": "user", "content": prompt}]
)
```

#### 4. File Output
```python
timestamp = datetime.now().strftime("%Y-%m-%dT%H-%M-%S")
out_path = f"output/changelog_{timestamp}.txt"
```

## Configuration Options

### Commit History Limit

Modify the number of commits to analyze:
```python
# Change "-n", "10" to desired number
git_log = subprocess.check_output([
    "git", "log", "--pretty=format:* %s", "-n", "20"  # Last 20 commits
]).decode()
```

### Output Format

Customize the AI prompt for different output styles:
```python
prompt = f"""Custom instructions here...
Include specific formatting requirements or categorization preferences.

Commits:
{git_log}
"""
```

### Token Limit

Adjust the response length:
```python
response = client.messages.create(
    model=model,
    max_tokens=2000,  # Increase for longer changelogs
    messages=[{"role": "user", "content": prompt}]
)
```

## Error Handling

The script includes error handling for:

- **Git command failures**: Gracefully handles repositories without Git history
- **Missing environment variables**: Uses default model if not specified
- **API failures**: Should be wrapped in try-catch for production use
- **File system operations**: Creates output directory if it doesn't exist

## Troubleshooting

### Common Issues

| Issue | Solution |
|-------|----------|
| "No commits found" | Ensure you're in a Git repository with commit history |
| API key errors | Verify `ANTHROPIC_API_KEY` is set correctly in `.env` |
| Permission errors | Check write permissions for `output/` directory |
| Git command not found | Ensure Git is installed and accessible in PATH |

### Debug Mode

Add debug output for troubleshooting:
```python
print(f"üìä Found {len(git_log.split('*'))-1} commits")
print(f"ü§ñ Using model: {model}")
print(f"üìù Generated {len(notes)} characters")
```

## Security Considerations

- Store API keys in environment variables, never in code
- Add `.env` to your `.gitignore` file
- Consider API rate limits for large repositories
- Validate Git command output before processing

## License

This documentation is provided as-is for the changelog generator utility.