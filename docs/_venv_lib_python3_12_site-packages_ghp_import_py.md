<!-- Auto-generated by Claude on 2025-05-31 21:12 -->

# ghp-import Documentation

## Overview

`ghp-import` is a Python utility for importing documentation or static site files into a Git repository's `gh-pages` branch (or any specified branch). This tool is commonly used to publish static websites to GitHub Pages by automating the process of committing files to a deployment branch.

## Purpose

The primary purpose of this tool is to:
- Import a directory of static files into a Git branch
- Manage GitHub Pages deployments
- Automate the process of updating documentation branches
- Handle Git operations for static site deployment

## Key Features

- **Branch Management**: Creates or updates a specified Git branch (default: `gh-pages`)
- **File Import**: Recursively imports all files from a source directory
- **Jekyll Support**: Option to include `.nojekyll` file for non-Jekyll sites
- **Custom Domain**: Support for `CNAME` file creation
- **Git Integration**: Uses Git's fast-import for efficient bulk operations
- **Cross-platform**: Compatible with Python 2 and 3

## Classes

### `GhpError`
Custom exception class for handling ghp-import specific errors.

```python
class GhpError(Exception):
    def __init__(self, message):
        self.message = message
```

### `Git`
Main class for handling Git operations and repository management.

**Key Methods:**
- `check_repo()`: Validates if current directory is a Git repository
- `try_rebase()`: Attempts to rebase the target branch
- `get_config()`: Retrieves Git configuration values
- `call()`: Executes Git commands and returns status code
- `check_call()`: Executes Git commands with error checking

## Important Functions

### `ghp_import(srcdir, **kwargs)`
The main function that orchestrates the import process.

**Parameters:**
- `srcdir`: Source directory containing files to import
- `**kwargs`: Configuration options (branch, message, push, etc.)

**Process:**
1. Validates source directory exists
2. Initializes Git operations
3. Prepares target branch
4. Imports files using Git fast-import
5. Optionally pushes to remote repository

### `run_import(git, srcdir, **opts)`
Handles the actual file import process using Git's fast-import feature.

### `start_commit(pipe, git, branch, message, prefix=None)`
Initiates a new commit in the target branch with proper metadata.

### File Management Functions
- `add_file(pipe, srcpath, tgtpath)`: Adds individual files to the commit
- `add_nojekyll(pipe, prefix=None)`: Creates `.nojekyll` file for non-Jekyll sites
- `add_cname(pipe, cname)`: Creates `CNAME` file for custom domains

## Command Line Options

| Option | Description | Default |
|--------|-------------|---------|
| `-b, --branch` | Target branch name | `gh-pages` |
| `-m, --message` | Commit message | `"Update documentation"` |
| `-p, --push` | Push to remote after commit | `False` |
| `-r, --remote` | Remote repository name | `origin` |
| `-f, --force` | Force push to repository | `False` |
| `-n, --no-jekyll` | Include `.nojekyll` file | `False` |
| `-c, --cname` | Create CNAME file with domain | `None` |
| `-x, --prefix` | Add prefix to file paths | `None` |
| `-o, --no-history` | Create commit without parent history | `False` |
| `-l, --follow-links` | Follow symbolic links | `False` |
| `-s, --shell` | Use shell for Git commands | `False` |

## Usage Examples

### Basic Usage
```bash
# Import current directory to gh-pages branch
ghp-import .

# Import specific directory
ghp-import /path/to/build/directory
```

### Advanced Usage
```bash
# Import with custom commit message and push
ghp-import -m "Deploy v2.0" -p ./dist

# Import to custom branch with force push
ghp-import -b deployment -f ./build

# Import with Jekyll disabled and custom domain
ghp-import -n -c example.com ./site
```

### Programmatic Usage
```python
from ghp_import import ghp_import

# Basic import
ghp_import('./build')

# Advanced import with options
ghp_import('./dist', branch='deploy', push=True, force=True, nojekyll=True)
```

## Notes and Considerations

### ‚ö†Ô∏è Important Warnings
- **Destructive Operation**: This tool replaces the entire contents of the target branch
- **Backup Recommended**: Always backup important branches before running
- **Force Push**: Use `--force` option carefully as it overwrites remote history

### üîß Technical Notes
- Uses Git's `fast-import` for efficient bulk operations
- Maintains file permissions (executable bit)
- Supports both Python 2 and 3 with appropriate encoding handling
- Handles timezone information for commit timestamps

### üí° Best Practices
- Test with a non-production branch first
- Use meaningful commit messages
- Consider using `--prefix` for partial directory updates
- Include `.nojekyll` for non-Jekyll static sites on GitHub Pages

### üêõ Error Handling
The tool provides clear error messages for common issues:
- Invalid Git repositories
- Missing source directories
- Git operation failures
- Permission problems

## Dependencies

- `subprocess`: Git command execution
- `dateutil`: Timezone handling
- `os`, `sys`: System operations
- `time`: Timestamp generation
- `shlex`/`pipes`: Command shell escaping (Python version dependent)