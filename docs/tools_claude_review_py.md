<!-- Auto-generated by Claude on 2025-06-02 08:28 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can analyze either specific source files or Git diffs, providing structured feedback in Markdown format.

## Purpose

This tool automates the code review process by:
- Analyzing source code for bugs, logic issues, and style consistency
- Reviewing Git diffs for changes between commits
- Generating comprehensive feedback in a readable Markdown format
- Integrating AI-powered insights into development workflows

## Features

- **Dual Mode Operation**: Can review individual files or Git diffs
- **Markdown Output**: Generates well-formatted documentation
- **Git Integration**: Automatically detects and analyzes code changes
- **Error Handling**: Gracefully handles missing files and Git errors
- **Configurable**: Uses environment variables for API configuration

## Requirements

### Dependencies
```python
anthropic  # Claude AI API client
python-dotenv  # Environment variable management
```

### Environment Variables
Create a `.env` file with:
```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
```

## Usage

### Mode 1: File Review
Review specific source files:
```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review
Review changes in your Git repository:
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with proper syntax highlighting
- Combines multiple files into a single review context

### `get_git_diff()`
Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff string or empty string if unavailable

**Fallback Logic:**
1. Tries `git diff origin/main...HEAD` (preferred)
2. Falls back to `git diff HEAD^` if origin/main doesn't exist
3. Returns empty string if both fail

### `main()`
Main execution function that:
- Sets up the Claude API client
- Determines review mode based on command-line arguments
- Generates appropriate prompts for Claude
- Handles API communication and error management
- Saves formatted output to `docs/claude_review.md`

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:
- Timestamp of the review
- Structured feedback focusing on:
  - Bugs or logic issues
  - Code clarity and readability
  - Suggested improvements
  - Style consistency

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Tries multiple Git diff strategies
- **API Errors**: Catches and reports Claude API issues
- **No Changes**: Creates stub review when no diff is available

## Notes and Suggestions

### Best Practices
- Ensure your `ANTHROPIC_API_KEY` is properly configured
- Run the tool from your project's root directory for best Git integration
- Review the generated Markdown file before making changes

### Limitations
- Limited to 1500 tokens per review (configurable in code)
- Assumes Python files for syntax highlighting (easily modifiable)
- Requires active internet connection for Claude API

### Potential Improvements
- Add support for multiple programming languages
- Implement token counting to optimize API usage
- Add configuration file support for custom review criteria
- Include code metrics and complexity analysis

### Security Considerations
- Store API keys securely using environment variables
- Be mindful of sending proprietary code to external APIs
- Consider using local AI models for sensitive codebases

## File Structure

The tool creates the following structure:
```
project/
├── docs/
│   └── claude_review.md  # Generated review output
├── .env                  # Environment configuration
└── claude_review.py      # Main script
```