<!-- Auto-generated by Claude on 2025-06-01 09:28 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool outputs structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes in Git diffs automatically
- **Markdown Output**: Generate readable, structured review reports
- **Development Workflow**: Streamline code review processes in teams

## Features

- **Dual Operation Modes**: File-specific reviews or Git diff analysis
- **Intelligent Fallback**: Automatically tries different Git diff strategies
- **Structured Output**: Clean Markdown formatting with timestamps
- **Environment Configuration**: Flexible API key and model configuration

## Requirements

### Dependencies
```python
anthropic      # Claude AI API client
python-dotenv  # Environment variable management
```

### Environment Variables
Create a `.env` file with:
```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
```

## Usage

### Mode 1: Review Specific Files
```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Review Git Diff
```bash
python claude_review.py
```
*Note: Running without arguments automatically triggers Git diff mode*

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warnings
- Formats code in fenced code blocks
- Adds file path headers for clarity

### `get_git_diff()`
Retrieves Git diff output with intelligent fallback strategy.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. First attempts: `git diff origin/main...HEAD`
2. If failed, tries: `git diff HEAD^`
3. Returns empty string if both fail

### `main()`
Core orchestration function that handles:
- Environment setup and API client initialization
- Mode detection (file review vs Git diff)
- Claude API interaction
- Output file generation

## Output

### File Structure
```
docs/
‚îî‚îÄ‚îÄ claude_review.md    # Generated review report
```

### Report Format
```markdown
# üß† Claude Review

_Last updated: YYYY-MM-DD HH:MM_

[Claude's structured feedback here]
```

## Review Focus Areas

The tool instructs Claude to focus on:
- **Bugs or Logic Issues**: Potential runtime errors or logical flaws
- **Code Clarity**: Readability and maintainability concerns  
- **Suggested Improvements**: Performance and design recommendations
- **Style Consistency**: Coding standards and formatting

## Error Handling

### Graceful Degradation
- **Missing Files**: Warns and skips non-existent files
- **Git Issues**: Falls back to alternative diff strategies
- **No Changes**: Creates stub review when no diff available
- **API Errors**: Provides clear error messages and exits cleanly

### Status Indicators
- ‚úÖ Success operations
- ‚ö†Ô∏è Warnings and fallbacks  
- ‚ùå Critical errors
- üì¶ Git operations
- üìù File operations

## Configuration Notes

### Model Selection
- Default: `claude-sonnet-4-20250514`
- Override via `ANTHROPIC_MODEL` environment variable
- Consider token limits (current: 1500 max tokens)

### Output Customization
- Reviews saved to `docs/claude_review.md`
- Directory created automatically if missing
- Timestamps in `YYYY-MM-DD HH:MM` format

## Best Practices

### Usage Recommendations
- **Small Changesets**: Review focused, manageable code changes
- **Pre-commit**: Integrate into Git hooks for automatic reviews
- **Team Standards**: Use consistently across development team
- **Token Management**: Monitor API usage for cost optimization

### Limitations
- **Token Limits**: Large files may be truncated
- **Language Assumption**: Hardcoded for Python syntax highlighting
- **Git Dependency**: Requires Git repository for diff mode
- **API Dependency**: Requires active Anthropic API key

## Integration Examples

### Git Hook Integration
```bash
#!/bin/sh
# Pre-push hook
python claude_review.py
```

### CI/CD Pipeline
```yaml
- name: Code Review
  run: python claude_review.py
- name: Upload Review
  uses: actions/upload-artifact@v3
  with:
    name: code-review
    path: docs/claude_review.md
```