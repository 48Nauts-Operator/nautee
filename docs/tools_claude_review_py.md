<!-- Auto-generated by Claude on 2025-06-08 06:34 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can analyze either specific source files or Git diffs, providing structured feedback in Markdown format.

## Purpose

This tool automates the code review process by:
- Analyzing Python source files for bugs, clarity, and style issues
- Reviewing Git diffs to provide feedback on changes
- Generating structured Markdown reports with actionable suggestions
- Integrating with development workflows for consistent code quality

## Installation & Setup

### Prerequisites

- Python 3.6+
- Anthropic API key
- Git (for diff review mode)

### Required Dependencies

```bash
pip install anthropic python-dotenv
```

### Environment Configuration

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

The tool supports two operational modes:

### Mode 1: Manual File Review

Review specific source files:

```bash
python claude_review.py file1.py file2.py [additional_files...]
```

### Mode 2: Git Diff Review

Review changes in your Git repository:

```bash
python claude_review.py
```

The tool will attempt to get a diff using:
1. `git diff origin/main...HEAD` (preferred)
2. `git diff HEAD^` (fallback)

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with proper Markdown code blocks
- Includes file path headers for clarity

### `get_git_diff()`

Retrieves Git diff output with intelligent fallback logic.

**Returns:**
- `str`: Git diff string or empty string if unavailable

**Behavior:**
- First attempts `git diff origin/main...HEAD`
- Falls back to `git diff HEAD^` if origin/main doesn't exist
- Returns empty string if Git operations fail

### `main()`

Primary execution function that orchestrates the review process:

1. **Setup Phase**: Loads environment variables and initializes Claude client
2. **Mode Detection**: Determines whether to review files or Git diff
3. **Content Processing**: Prepares appropriate prompts for Claude
4. **API Interaction**: Sends requests to Claude and processes responses
5. **Output Generation**: Saves formatted review to Markdown file

## Output

### File Location
Reviews are saved to: `docs/claude_review.md`

### Format Structure
```markdown
# üß† Claude Review

_Last updated: YYYY-MM-DD HH:MM_

[Claude's structured feedback here]
```

## Review Focus Areas

Claude analyzes code for:

- **üêõ Bugs or logic issues**: Potential runtime errors or logical flaws
- **üìñ Code clarity**: Readability and maintainability concerns  
- **üí° Suggested improvements**: Performance and design recommendations
- **üé® Style consistency**: Adherence to Python conventions

## Error Handling

The tool includes robust error handling:

- **Missing files**: Warns and continues with available files
- **Git errors**: Graceful fallback between diff strategies
- **API failures**: Clear error messages with non-zero exit codes
- **Missing API key**: Automatic detection via environment variables

## Configuration Options

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `ANTHROPIC_API_KEY` | Your Claude API key | Required |
| `ANTHROPIC_MODEL` | Claude model to use | `claude-sonnet-4-20250514` |

### API Limits

- **Max tokens**: 1500 (configurable in code)
- **Model**: Defaults to Claude Sonnet 4
- **Rate limiting**: Handled by Anthropic SDK

## Notes & Suggestions

### üí° Best Practices

- **Regular reviews**: Integrate into CI/CD pipeline for consistent quality
- **Focused reviews**: Review smaller changesets for more detailed feedback
- **API costs**: Monitor usage as API calls incur costs

### üîß Potential Improvements

- Add support for multiple programming languages
- Implement configurable review criteria
- Add integration with GitHub/GitLab for automated PR reviews
- Include severity levels for different types of issues

### ‚ö†Ô∏è Limitations

- Currently optimized for Python files (though works with any text-based code)
- Requires internet connection for Claude API
- Review quality depends on code context and complexity
- API rate limits may affect usage in high-frequency scenarios

## Integration Examples

### Pre-commit Hook
```bash
#!/bin/sh
python claude_review.py && git add docs/claude_review.md
```

### CI/CD Pipeline
```yaml
- name: Code Review
  run: python claude_review.py
- name: Upload Review
  uses: actions/upload-artifact@v2
  with:
    name: code-review
    path: docs/claude_review.md
```