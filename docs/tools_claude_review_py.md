<!-- Auto-generated by Claude on 2025-06-01 15:19 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It operates in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes in Git diffs automatically
- **Documentation Generation**: Output structured reviews in Markdown format
- **Development Workflow**: Streamline code review processes in CI/CD pipelines

## Requirements

- Python 3.x
- Anthropic API key
- Git (for diff mode)
- Required packages: `anthropic`, `python-dotenv`

## Configuration

### Environment Variables

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

### Installation

```bash
pip install anthropic python-dotenv
```

## Usage Modes

### Mode 1: File Review

Review specific source files by passing them as command-line arguments:

```bash
python claude_review.py file1.py file2.py module/file3.py
```

### Mode 2: Git Diff Review

Review Git changes by running without arguments:

```bash
python claude_review.py
```

The tool attempts to get diffs in this order:
1. `git diff origin/main...HEAD`
2. `git diff HEAD^` (fallback)
3. Skip review if no diff available

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string for review.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warnings
- Formats each file as a separate code block
- Assumes Python syntax highlighting

### `get_git_diff()`

Retrieves Git diff output with intelligent fallback logic.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Behavior:**
- First tries `origin/main...HEAD` for feature branch comparisons
- Falls back to `HEAD^` for single commit diffs
- Returns empty string if Git operations fail

### `main()`

Orchestrates the entire review process:

1. **Setup Phase**: Loads environment variables and initializes API client
2. **Mode Detection**: Determines review mode based on command-line arguments
3. **Content Preparation**: Loads files or retrieves Git diff
4. **AI Review**: Sends content to Claude for analysis
5. **Output Generation**: Saves structured review to Markdown file

## Output

Reviews are saved to `docs/claude_review.md` with:

- **Header**: "ðŸ§  Claude Review" with timestamp
- **Structured Feedback**: AI-generated analysis focusing on:
  - Bugs or logic issues
  - Code clarity and readability
  - Suggested improvements
  - Style consistency

## Error Handling

The tool includes robust error handling for common scenarios:

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Graceful fallback between diff strategies
- **API Errors**: Catches and reports Claude API issues
- **No Content**: Creates stub review when no diff is available

## Suggestions and Best Practices

### ðŸ”§ Improvements

- **Language Detection**: Currently assumes Python syntax - consider auto-detecting file types
- **Configuration**: Add support for custom output paths and review templates
- **Batch Processing**: Could be enhanced to handle very large codebases more efficiently

### ðŸ’¡ Usage Tips

- **CI/CD Integration**: Run in automated pipelines for consistent code review
- **Pre-commit Hooks**: Integrate as a pre-commit check for immediate feedback
- **Team Standards**: Customize prompts to align with your team's coding standards
- **Rate Limiting**: Be mindful of API usage limits in high-frequency scenarios

### ðŸš¨ Security Notes

- Store API keys securely using environment variables
- Avoid committing sensitive code to public repositories when using this tool
- Consider data privacy implications when sending code to external APIs

## Example Output Structure

```markdown
# ðŸ§  Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
Brief overview of the code quality and main findings.

## Issues Found
- Critical bugs or logic errors
- Performance concerns
- Security vulnerabilities

## Suggestions
- Code clarity improvements
- Best practice recommendations
- Refactoring opportunities
```