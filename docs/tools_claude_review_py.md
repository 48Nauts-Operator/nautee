<!-- Auto-generated by Claude on 2025-06-22 13:27 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that performs automated code reviews using Anthropic's Claude AI model. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Leverage Claude AI to identify bugs, logic issues, and improvement opportunities
- **Git Integration**: Seamlessly review changes in Git diffs 
- **Documentation Generation**: Output structured Markdown reports for easy sharing and archiving
- **Development Workflow**: Integrate AI-powered code review into CI/CD pipelines or development processes

## Installation Requirements

```bash
pip install anthropic python-dotenv
```

## Environment Setup

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_claude_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage Modes

### Mode 1: Manual File Review
Review specific source files by passing them as command-line arguments:

```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review  
Run without arguments to automatically review Git changes:

```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string for review.

**Parameters:**
- `file_paths` (list): List of file paths to load

**Returns:**
- `str`: Markdown-formatted string containing all source files

**Features:**
- Handles missing files gracefully with warning messages
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting (may need adjustment for other languages)

### `get_git_diff()`
Retrieves Git diff output with fallback strategies for different Git configurations.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Git Strategies:**
1. First attempts: `git diff origin/main...HEAD`
2. Fallback: `git diff HEAD^` 
3. Returns empty string if both fail

## Main Workflow

1. **Environment Setup**: Loads environment variables and initializes Claude client
2. **Mode Detection**: Determines whether to review files or Git diff based on command-line arguments
3. **Content Preparation**: Formats code or diff for Claude analysis
4. **AI Review**: Sends formatted prompt to Claude API
5. **Output Generation**: Saves structured Markdown review to `docs/claude_review.md`

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:

- **Header**: "ðŸ§  Claude Review" with timestamp
- **Structured Feedback**: 
  - Bug identification and logic issues
  - Code clarity assessments  
  - Improvement suggestions
  - Style consistency notes

## Configuration Options

| Environment Variable | Default Value | Description |
|---------------------|---------------|-------------|
| `ANTHROPIC_API_KEY` | Required | Your Claude API key |
| `ANTHROPIC_MODEL` | `claude-sonnet-4-20250514` | Claude model to use |

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Graceful fallback between Git diff strategies
- **API Errors**: Exits with error code 1 and descriptive message
- **No Changes**: Creates stub review file when no diff is available

## Suggestions and Notes

### Improvements
- **Language Detection**: Currently assumes Python syntax highlighting - consider auto-detecting file types
- **Token Management**: 1500 token limit may be insufficient for large diffs or multiple files
- **Configuration**: Consider adding config file support for review criteria customization
- **Output Formats**: Could support additional output formats (JSON, HTML, etc.)

### Best Practices  
- **API Key Security**: Never commit `.env` files to version control
- **File Size Limits**: Be mindful of Claude's token limits when reviewing large files
- **Git Strategy**: Ensure your Git workflow aligns with the diff strategies used
- **Regular Updates**: Keep the Claude model version updated for best performance

### Integration Ideas
- Add as a Git pre-commit hook
- Integrate with GitHub Actions for PR reviews  
- Include in CI/CD pipelines for automated quality checks
- Extend to support multiple AI providers for comparison reviews