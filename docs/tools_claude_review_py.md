<!-- Auto-generated by Claude on 2025-06-23 06:32 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that automates code review using Anthropic's Claude AI. It can analyze either specific source files or Git diffs, providing structured feedback in Markdown format.

## Purpose

This tool serves as an automated code reviewer that can:
- Analyze individual source files for bugs, clarity, and improvements
- Review Git diffs to provide feedback on changes
- Generate structured Markdown reports for easy reading and documentation

## Requirements

### Dependencies
- `anthropic` - Anthropic's Python client library
- `python-dotenv` - Environment variable management
- `subprocess` - Git command execution (built-in)
- `os`, `sys`, `datetime` - Standard library modules

### Environment Variables
- `ANTHROPIC_API_KEY` - Required API key for Claude access
- `ANTHROPIC_MODEL` - Optional model specification (defaults to `claude-sonnet-4-20250514`)

## Usage

The script operates in two modes:

### Mode 1: Manual File Review
```bash
python claude_review.py file1.py file2.py [additional_files...]
```

### Mode 2: Git Diff Review
```bash
python claude_review.py
```
*When no files are specified, the tool automatically reviews Git changes*

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting

### `get_git_diff()`
Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Behavior:**
- First attempts: `git diff origin/main...HEAD`
- Fallback: `git diff HEAD^`
- Returns empty string if both fail

### `main()`
Primary execution function that orchestrates the review process.

**Workflow:**
1. Loads environment variables and initializes Claude client
2. Creates output directory (`docs/`)
3. Determines review mode based on command-line arguments
4. Constructs appropriate prompt for Claude
5. Calls Claude API and saves formatted results

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:
- Timestamp header
- Structured feedback from Claude
- Analysis focusing on:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements
  - Style consistency

## Error Handling

- **Missing files**: Warns and skips non-existent files
- **Git errors**: Graceful fallback between different Git diff strategies
- **API errors**: Catches and reports Claude API exceptions
- **No diff available**: Creates stub review file when no changes are found

## Notes and Suggestions

### ‚ö†Ô∏è Important Considerations

1. **API Key Security**: Ensure your `ANTHROPIC_API_KEY` is properly secured and not committed to version control

2. **File Type Assumption**: The `load_code()` function assumes Python syntax highlighting. Consider making this configurable for multi-language projects

3. **Token Limits**: Current max_tokens is set to 1500, which may be insufficient for large diffs or multiple files

### üîß Potential Improvements

- **Language Detection**: Auto-detect file types for proper syntax highlighting
- **Configurable Output**: Allow custom output paths and formats
- **Batch Processing**: Add support for directory scanning
- **Error Recovery**: Implement retry logic for API failures
- **Configuration File**: Support for `.claude-review.config` files

### üí° Usage Tips

- Run the tool as part of your CI/CD pipeline for automated reviews
- Use it before submitting pull requests for self-review
- Combine with pre-commit hooks for continuous feedback
- Review the generated Markdown files in your documentation workflow

## Example Output Structure

```markdown
# üß† Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
[Claude's analysis summary]

## Issues Found
[Detailed issue descriptions]

## Suggestions
[Improvement recommendations]
```