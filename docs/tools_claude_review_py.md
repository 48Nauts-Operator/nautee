<!-- Auto-generated by Claude on 2025-06-02 07:21 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It provides structured feedback on source code files or Git diffs, outputting comprehensive Markdown-formatted reviews.

## Purpose

This tool automates the code review process by:
- Analyzing individual source files or Git diffs
- Providing structured feedback on code quality, bugs, and improvements
- Generating readable Markdown documentation for review results
- Integrating with Git workflows for diff-based reviews

## Features

- **Dual Operation Modes**: Review specific files or analyze Git diffs
- **AI-Powered Analysis**: Uses Claude AI for intelligent code review
- **Markdown Output**: Generates structured, readable review documentation
- **Git Integration**: Automatically detects and reviews code changes
- **Error Handling**: Graceful handling of missing files and Git errors

## Installation & Setup

### Prerequisites

```bash
pip install anthropic python-dotenv
```

### Environment Configuration

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_claude_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

### Mode 1: File Review

Review specific source files:

```bash
python claude_review.py file1.py file2.py module/file3.py
```

### Mode 2: Git Diff Review

Review changes in Git diff (no arguments):

```bash
python claude_review.py
```

## Core Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warnings
- Formats each file with appropriate code blocks
- Handles file reading errors gracefully

### `get_git_diff()`

Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. Attempts `git diff origin/main...HEAD`
2. Falls back to `git diff HEAD^` if origin/main doesn't exist
3. Returns empty string if both fail

### `main()`

Primary execution function that orchestrates the review process.

**Workflow:**
1. Loads environment variables and initializes Claude client
2. Determines operation mode based on command-line arguments
3. Prepares appropriate prompts for Claude
4. Makes API call and processes response
5. Saves formatted review to `docs/claude_review.md`

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:

- **Header**: "ðŸ§  Claude Review" with timestamp
- **Structured Feedback**: Claude's analysis including:
  - Bug identification and logic issues
  - Code clarity assessments
  - Improvement suggestions
  - Style consistency recommendations

## Configuration

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `ANTHROPIC_API_KEY` | Your Claude API key | Required |
| `ANTHROPIC_MODEL` | Claude model to use | `claude-sonnet-4-20250514` |

### API Parameters

- **Max Tokens**: 1500 (configurable in code)
- **Model**: Configurable via environment variable
- **Role**: User role for all prompts

## Error Handling

The tool includes robust error handling for:

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Falls back through multiple Git diff strategies
- **API Errors**: Catches and reports Claude API issues
- **Environment Issues**: Handles missing API keys gracefully

## Notes and Suggestions

### Best Practices

- **API Key Security**: Keep your `ANTHROPIC_API_KEY` secure and never commit it to version control
- **File Size Limits**: Be mindful of token limits when reviewing large files
- **Git Repository**: Ensure you're in a Git repository for diff mode to work properly

### Limitations

- **Token Limit**: Reviews are capped at 1500 tokens, which may truncate large analyses
- **Python Focus**: Code formatting assumes Python files (though it works with any text files)
- **Git Dependency**: Diff mode requires Git and proper repository setup

### Potential Improvements

- Add support for custom output directories
- Implement file type detection for better syntax highlighting
- Add configuration file support for persistent settings
- Include support for multiple AI models/providers
- Add batch processing capabilities for large codebases

## Example Output Structure

```markdown
# ðŸ§  Claude Review

_Last updated: 2024-01-15 14:30_

## Code Quality Analysis

### Bugs and Logic Issues
- [Analysis details]

### Code Clarity
- [Clarity feedback]

### Suggested Improvements
- [Improvement recommendations]

### Style Consistency
- [Style observations]
```