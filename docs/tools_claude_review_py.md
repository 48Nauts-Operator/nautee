<!-- Auto-generated by Claude on 2025-06-01 14:17 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can analyze either specific source files or Git diffs, providing structured feedback in Markdown format.

## Purpose

This tool serves as an automated code reviewer that can:
- Review individual source files for bugs, clarity, and improvements
- Analyze Git diffs to provide feedback on code changes
- Generate structured, readable reports in Markdown format
- Integration into development workflows for continuous code quality assessment

## Features

- **Dual Mode Operation**: Works with both file paths and Git diffs
- **Automatic Git Integration**: Intelligently handles different Git scenarios
- **Markdown Output**: Generates clean, formatted documentation
- **Error Handling**: Graceful handling of missing files and Git issues
- **Configurable Model**: Supports different Claude model versions

## Installation Requirements

```bash
pip install anthropic python-dotenv
```

## Environment Setup

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
```

## Usage

### Mode 1: Review Specific Files
```bash
python claude_review.py file1.py file2.py module/file3.py
```

### Mode 2: Review Git Diff
```bash
python claude_review.py
```

## Core Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with proper Markdown syntax highlighting
- Handles file reading errors gracefully

### `get_git_diff()`

Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Behavior:**
- First attempts `git diff origin/main...HEAD`
- Falls back to `git diff HEAD^` if origin/main doesn't exist
- Returns empty string if both methods fail

### `main()`

Main execution function that orchestrates the review process.

**Key Steps:**
1. Loads environment variables and initializes Claude client
2. Creates output directory structure
3. Determines operation mode based on command-line arguments
4. Generates appropriate prompts for Claude
5. Processes Claude's response and saves to file

## Output

The tool generates a file at `docs/claude_review.md` containing:

- **Header**: Title and timestamp
- **Structured Feedback**: Claude's analysis focusing on:
  - Bugs or logic issues
  - Code clarity and readability
  - Suggested improvements
  - Style consistency
  - Best practices

## Error Handling

The script includes robust error handling for:

- **Missing Files**: Warns about and skips non-existent files
- **Git Issues**: Gracefully handles repositories without proper Git history
- **API Errors**: Catches and reports Claude API failures
- **Empty Diffs**: Creates stub reviews when no changes are detected

## Configuration Options

### Environment Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `ANTHROPIC_API_KEY` | Required | Your Anthropic API key |
| `ANTHROPIC_MODEL` | `claude-sonnet-4-20250514` | Claude model version to use |

### Customization

The script can be easily modified to:
- Change output directory from `docs/`
- Adjust Claude's max_tokens limit (currently 1500)
- Modify review focus areas in the prompts
- Add additional file type support

## Notes and Suggestions

### Best Practices

- **API Key Security**: Store your API key in `.env` file, never commit it to version control
- **File Size Limits**: Be mindful of Claude's token limits when reviewing large files
- **Git Integration**: Ensure your repository has proper remote setup for optimal diff detection

### Potential Improvements

- Add support for multiple output formats (HTML, PDF)
- Implement file type detection and language-specific prompts
- Add configuration file support for custom review criteria
- Include integration with popular CI/CD platforms
- Add batch processing capabilities for large codebases

### Limitations

- Requires active internet connection for Claude API
- Limited by Claude's context window for very large diffs
- Git diff mode requires proper Git repository setup
- Currently hardcoded for Python syntax highlighting in file mode

## Example Output Structure

```markdown
# ðŸ§  Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
Brief overview of the code review findings...

## Issues Found
- Critical bugs or logic errors
- Performance concerns
- Security considerations

## Suggestions
- Code improvement recommendations
- Best practice implementations
- Refactoring opportunities

## Style and Clarity
- Formatting inconsistencies
- Naming conventions
- Documentation gaps
```