<!-- Auto-generated by Claude on 2025-06-23 09:25 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It supports two review modes:

1. **Manual File Review** - Analyze specific source files provided as command-line arguments
2. **Git Diff Review** - Automatically review changes in a Git repository by analyzing diffs

The tool outputs structured feedback as a Markdown file, making it easy to integrate into development workflows and documentation systems.

## Purpose

- Automate code review processes using AI assistance
- Provide consistent, structured feedback on code quality
- Support both targeted file analysis and Git-based change reviews
- Generate documentation-ready output in Markdown format

## Key Features

- **Dual Review Modes**: File-based or Git diff analysis
- **Markdown Output**: Clean, structured feedback format
- **Error Handling**: Graceful handling of missing files and Git errors
- **Configurable Model**: Support for different Claude model versions
- **Timestamped Reports**: Automatic timestamping of review outputs

## Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string for review.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all source files

**Features:**
- Skips missing files with warning messages
- Formats each file as a separate code block
- Assumes Python syntax highlighting (could be enhanced for multi-language support)

### `get_git_diff()`

Retrieves Git diff output with fallback strategies for different repository states.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. First attempts `git diff origin/main...HEAD`
2. Falls back to `git diff HEAD^` if origin/main doesn't exist
3. Returns empty string if both fail

## Usage

### Prerequisites

1. Install required dependencies:
   ```bash
   pip install anthropic python-dotenv
   ```

2. Set up environment variables in `.env` file:
   ```env
   ANTHROPIC_API_KEY=your_claude_api_key_here
   ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
   ```

### Running the Tool

**Mode 1: Review Specific Files**
```bash
python claude_review.py file1.py file2.py file3.py
```

**Mode 2: Review Git Changes**
```bash
python claude_review.py
```

### Output

Reviews are saved to `docs/claude_review.md` with the following structure:
- Header with brain emoji and timestamp
- Structured feedback focusing on:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements
  - Style consistency

## Configuration

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `ANTHROPIC_API_KEY` | Your Claude API key | **Required** |
| `ANTHROPIC_MODEL` | Claude model version | `claude-sonnet-4-20250514` |

### Output Location

- Creates `docs/` directory if it doesn't exist
- Always outputs to `docs/claude_review.md`
- Overwrites previous reviews

## Suggestions for Improvement

### Code Enhancements

1. **Multi-language Support**
   ```python
   # Add language detection based on file extension
   def get_language(file_path):
       ext_map = {'.py': 'python', '.js': 'javascript', '.java': 'java'}
       return ext_map.get(Path(file_path).suffix, 'text')
   ```

2. **Configurable Output Path**
   ```python
   # Allow custom output paths
   output_path = os.getenv("CLAUDE_OUTPUT_PATH", "docs/claude_review.md")
   ```

3. **Review History**
   ```python
   # Append to history instead of overwriting
   output_path = f"docs/claude_review_{datetime.now().strftime('%Y%m%d_%H%M%S')}.md"
   ```

### Error Handling

- Add validation for API key presence
- Implement retry logic for API failures
- Better handling of binary files in file mode

### Features

- Support for custom review prompts
- Integration with GitHub/GitLab APIs for PR reviews
- Configuration file support for team-wide settings
- Support for excluding certain file types or directories

## Dependencies

- `anthropic`: Claude AI API client
- `python-dotenv`: Environment variable management
- `subprocess`: Git command execution
- Standard library: `os`, `sys`, `datetime`

## Notes

- The tool assumes Python files when using manual file review mode
- Git diff mode requires a Git repository with commit history
- API usage will count against your Anthropic Claude quota
- Output is always in English; internationalization not currently supported