<!-- Auto-generated by Claude on 2025-06-01 11:15 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can operate in two modes:
1. **Manual File Review**: Analyze specific source files provided as command-line arguments
2. **Git Diff Review**: Automatically review changes in a Git repository by analyzing diffs

The tool outputs structured feedback in Markdown format, making it easy to integrate into development workflows and documentation systems.

## Purpose

- Automate code review processes using AI
- Provide consistent, structured feedback on code changes
- Generate documentation-ready review reports
- Support both targeted file analysis and Git-based change review

## Requirements

- Python 3.x
- `anthropic` Python package
- `python-dotenv` package
- Git (for diff mode)
- Anthropic API key

## Environment Setup

Create a `.env` file in your project root with:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

### Manual File Review Mode
```bash
python claude_review.py file1.py file2.py [additional_files...]
```

### Git Diff Review Mode
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string for review.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warning messages
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting (may need adjustment for other languages)

### `get_git_diff()`

Retrieves Git diff output using fallback strategies for maximum compatibility.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. First attempts `git diff origin/main...HEAD`
2. Falls back to `git diff HEAD^` if origin/main doesn't exist
3. Returns empty string if both fail

### `main()`

Main execution function that orchestrates the review process.

**Workflow:**
1. Loads environment variables and initializes Claude client
2. Creates output directory structure
3. Determines operation mode based on command-line arguments
4. Generates appropriate prompts for Claude
5. Calls Claude API and processes response
6. Saves formatted review to Markdown file

## Output

Reviews are saved to `docs/claude_review.md` with:
- Timestamp header
- Structured Markdown formatting
- Focus areas including:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements
  - Style consistency

## Error Handling

The tool includes robust error handling for:
- Missing files (continues with warnings)
- Git command failures (graceful fallback)
- API errors (exits with error code)
- Missing environment variables

## Notes and Suggestions

### ‚ö†Ô∏è Current Limitations

- **Language Assumption**: The `load_code()` function hardcodes Python syntax highlighting
- **Output Path**: Fixed output location may not suit all workflows
- **Token Limits**: 1500 token limit may be insufficient for large diffs

### üîß Suggested Improvements

1. **Language Detection**:
   ```python
   # Add file extension mapping for proper syntax highlighting
   LANGUAGE_MAP = {'.py': 'python', '.js': 'javascript', '.java': 'java'}
   ```

2. **Configurable Output**:
   ```python
   output_path = os.getenv("REVIEW_OUTPUT_PATH", "docs/claude_review.md")
   ```

3. **Dynamic Token Limits**:
   ```python
   max_tokens = int(os.getenv("MAX_TOKENS", "1500"))
   ```

4. **Enhanced Git Integration**:
   - Support for custom base branches
   - Specific commit range reviews
   - Integration with pull request workflows

### üöÄ Integration Ideas

- **CI/CD Pipeline**: Integrate as a pre-commit hook or GitHub Action
- **IDE Extension**: Wrap in a VS Code or other IDE extension
- **Team Workflows**: Use with code review platforms like GitHub, GitLab, or Bitbucket

## Example Output Structure

```markdown
# üß† Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
[AI-generated review summary]

## Issues Found
- [Specific issues and recommendations]

## Suggestions
- [Improvement suggestions]
```