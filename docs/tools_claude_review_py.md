<!-- Auto-generated by Claude on 2025-06-02 06:37 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. The tool supports two modes of operation:

1. **Manual File Review**: Review specific source files provided as command-line arguments
2. **Git Diff Review**: Automatically review changes in a Git repository by analyzing diffs

The tool outputs structured feedback in Markdown format, making it easy to integrate into development workflows and documentation.

## Purpose

This tool is designed to:
- Provide automated code review feedback using AI
- Identify bugs, logic issues, and improvement opportunities
- Ensure code clarity and style consistency
- Generate structured, readable review reports in Markdown format
- Support both targeted file reviews and Git-based change reviews

## Requirements

### Dependencies
- `anthropic` - Anthropic's Python SDK for Claude API
- `python-dotenv` - Environment variable management
- `subprocess` - Git command execution (built-in)
- `os`, `sys`, `datetime` - Standard Python libraries

### Environment Variables
Create a `.env` file with the following variables:
```bash
ANTHROPIC_API_KEY=your_claude_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string for review.

**Parameters:**
- `file_paths` (list): List of file paths to load and combine

**Returns:**
- `str`: Markdown-formatted string containing all source files

**Features:**
- Handles missing files gracefully with warnings
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting (may need adjustment for other languages)

### `get_git_diff()`
Retrieves Git diff output with fallback strategies for different repository states.

**Returns:**
- `str`: Git diff string or empty string if unavailable

**Diff Strategy:**
1. First attempts: `git diff origin/main...HEAD`
2. Fallback: `git diff HEAD^` if origin/main doesn't exist
3. Returns empty string if both fail

### `main()`
The primary function that orchestrates the entire review process.

**Workflow:**
1. Loads environment variables and initializes Claude client
2. Creates output directory (`docs/`) if it doesn't exist
3. Determines review mode based on command-line arguments
4. Generates appropriate prompt for Claude
5. Calls Claude API and processes response
6. Saves formatted review to `docs/claude_review.md`

## Usage

### Manual File Review
```bash
python claude_review.py file1.py file2.py file3.py
```

### Git Diff Review
```bash
python claude_review.py
```
(No arguments triggers Git diff mode)

## Output

The tool generates a Markdown file at `docs/claude_review.md` with:
- Timestamp of the review
- Structured feedback focusing on:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements  
  - Style consistency

## Notes and Suggestions

### ‚ö†Ô∏è Important Considerations

1. **Language Assumption**: The `load_code()` function hardcodes Python syntax highlighting. Consider making this configurable for multi-language projects.

2. **API Limits**: The script sets `max_tokens=1500`, which may be insufficient for large diffs or multiple files. Consider making this configurable.

3. **Error Handling**: While basic error handling exists, consider adding more robust handling for network issues and API rate limits.

### üîß Suggested Improvements

1. **Configuration File**: Add support for a configuration file to customize:
   - Output directory and filename
   - Model selection
   - Token limits
   - Review focus areas

2. **Language Detection**: Implement automatic language detection for proper syntax highlighting:
   ```python
   def detect_language(file_path):
       extension = os.path.splitext(file_path)[1]
       language_map = {'.py': 'python', '.js': 'javascript', '.java': 'java'}
       return language_map.get(extension, 'text')
   ```

3. **Batch Processing**: For large repositories, consider adding support for reviewing files in batches to stay within API limits.

4. **Integration Options**: Consider adding support for:
   - GitHub Actions integration
   - Pre-commit hooks
   - CI/CD pipeline integration

### üí° Usage Tips

- Set up the tool as part of your development workflow
- Use manual file review for focused code reviews
- Use Git diff mode in CI/CD pipelines
- Review the generated Markdown files in your preferred editor or convert to other formats as needed

## Example Output Structure

```markdown
# üß† Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
[Claude's review summary]

## Issues Found
- [Specific issues and recommendations]

## Suggestions
- [Improvement recommendations]
```