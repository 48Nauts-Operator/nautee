<!-- Auto-generated by Claude on 2025-06-21 23:19 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can analyze either specific source files or Git diffs, providing structured feedback in a Markdown format.

## Purpose

This tool is designed to:
- Automate code review processes using AI assistance
- Provide consistent, structured feedback on code changes
- Support both manual file review and Git diff analysis
- Generate readable Markdown documentation of review results

## Features

- **Dual Mode Operation**: Review specific files or Git diffs
- **AI-Powered Analysis**: Uses Claude for intelligent code review
- **Markdown Output**: Generates structured, readable review reports
- **Git Integration**: Automatically detects and reviews code changes
- **Error Handling**: Gracefully handles missing files and Git errors

## Requirements

### Dependencies
```python
anthropic
python-dotenv
```

### Environment Variables
- `ANTHROPIC_API_KEY`: Your Anthropic API key (required)
- `ANTHROPIC_MODEL`: Claude model to use (optional, defaults to "claude-sonnet-4-20250514")

## Usage

### Mode 1: Manual File Review
```bash
python claude_review.py file1.py file2.py [additional_files...]
```

### Mode 2: Git Diff Review
```bash
python claude_review.py
```
When no files are specified, the tool automatically reviews Git changes.

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats code with proper syntax highlighting
- Preserves file structure and naming

### `get_git_diff()`
Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. Attempts `git diff origin/main...HEAD`
2. Falls back to `git diff HEAD^` if origin/main unavailable
3. Returns empty string if both fail

### `main()`
Primary execution function that orchestrates the review process.

**Key Operations:**
1. Environment setup and API client initialization
2. Mode detection (file review vs. Git diff)
3. Prompt construction for Claude API
4. API interaction and response handling
5. Output file generation

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:
- Timestamp of the review
- Structured feedback focusing on:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements
  - Style consistency

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Tries multiple Git diff strategies
- **API Errors**: Exits gracefully with error message
- **No Changes**: Creates stub review when no diff available

## Configuration Notes

### Model Selection
The default model is "claude-sonnet-4-20250514". You can override this by setting the `ANTHROPIC_MODEL` environment variable.

### Output Directory
The tool automatically creates a `docs/` directory if it doesn't exist.

## Suggestions for Improvement

1. **Configuration File**: Consider adding a configuration file for customizable review criteria
2. **Multiple Output Formats**: Add support for other output formats (HTML, JSON)
3. **Integration**: Add webhook support for CI/CD integration
4. **Caching**: Implement caching to avoid re-reviewing unchanged code
5. **Language Detection**: Add automatic language detection for better syntax highlighting
6. **Custom Prompts**: Allow users to specify custom review prompts
7. **Batch Processing**: Add support for reviewing multiple repositories

## Security Considerations

- Ensure your `ANTHROPIC_API_KEY` is kept secure and not committed to version control
- Use `.env` files for local development
- Consider API rate limiting for production use
- Be mindful of sending sensitive code to external APIs