<!-- Auto-generated by Claude on 2025-05-31 21:12 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It supports two primary modes of operation:

1. **Manual File Review**: Reviews specific source files provided as command-line arguments
2. **Git Diff Review**: Automatically reviews changes in a Git repository by analyzing diffs

The tool outputs structured feedback in Markdown format, making it easy to integrate into development workflows and documentation systems.

## Purpose

- Automate code review processes using AI-powered analysis
- Provide consistent, structured feedback on code quality
- Support both targeted file reviews and Git-based change reviews
- Generate documentation-ready output in Markdown format

## Installation & Setup

### Prerequisites

- Python 3.x
- Anthropic API key
- Git (for diff mode)

### Required Dependencies

```bash
pip install anthropic python-dotenv
```

### Environment Configuration

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

### Mode 1: Manual File Review

Review specific files by providing them as command-line arguments:

```bash
python claude_review.py file1.py file2.py src/module.py
```

### Mode 2: Git Diff Review

Review recent changes automatically:

```bash
python claude_review.py
```

The tool will attempt to get diff using:
1. `git diff origin/main...HEAD` (preferred)
2. `git diff HEAD^` (fallback)

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warnings
- Formats each file with proper syntax highlighting
- Uses file paths as section headers

### `get_git_diff()`

Retrieves Git diff output with intelligent fallback strategy.

**Returns:**
- `str`: Git diff output or empty string if unavailable

**Behavior:**
- First attempts `git diff origin/main...HEAD`
- Falls back to `git diff HEAD^` if origin/main doesn't exist
- Returns empty string if both commands fail

### `main()`

The primary orchestration function that:
- Loads environment configuration
- Determines operation mode based on command-line arguments
- Constructs appropriate prompts for Claude
- Makes API calls and handles responses
- Writes formatted output to file

## Output

### File Location
- **Output Directory**: `docs/`
- **Output File**: `docs/claude_review.md`

### Output Format
```markdown
# ðŸ§  Claude Review

_Last updated: YYYY-MM-DD HH:MM_

[Claude's review content here]
```

## Review Focus Areas

The tool instructs Claude to focus on:

- **Bugs or Logic Issues**: Potential runtime errors or logical flaws
- **Code Clarity**: Readability and maintainability concerns  
- **Suggested Improvements**: Optimization and best practice recommendations
- **Style Consistency**: Adherence to coding standards and patterns

## Error Handling

- **Missing Files**: Warns about missing files but continues processing others
- **Git Errors**: Gracefully handles missing Git repository or branches
- **API Errors**: Catches and reports Claude API failures
- **No Diff Available**: Creates a stub review file when no changes are detected

## Configuration Options

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `ANTHROPIC_API_KEY` | Your Anthropic API key | Required |
| `ANTHROPIC_MODEL` | Claude model to use | `claude-sonnet-4-20250514` |

### Token Limits

- **Max Tokens**: 1500 (configured in API call)
- Suitable for most code review scenarios
- May need adjustment for very large diffs

## Best Practices

### Usage Recommendations

- **Regular Integration**: Run as part of CI/CD pipelines or pre-commit hooks
- **Targeted Reviews**: Use manual file mode for specific components
- **Change Reviews**: Use Git diff mode for pull request reviews

### Limitations to Consider

- **Token Limits**: Large files or diffs may be truncated
- **API Costs**: Each review consumes Anthropic API credits
- **Language Assumption**: Currently optimized for Python (though adaptable)

## Troubleshooting

### Common Issues

1. **API Key Not Found**
   - Ensure `.env` file exists and contains valid `ANTHROPIC_API_KEY`

2. **Git Diff Empty**
   - Check if you're in a Git repository
   - Verify there are uncommitted changes or commits to compare

3. **File Not Found Warnings**
   - Check file paths for typos
   - Ensure files exist in the specified locations

### Debug Tips

- Check the console output for detailed status messages
- Verify the `docs/` directory is created successfully
- Review the generated Markdown file for completeness

## Future Enhancements

### Potential Improvements

- **Multi-language Support**: Extend beyond Python files
- **Configurable Output**: Custom output formats and locations  
- **Integration Options**: Direct GitHub/GitLab integration
- **Review Templates**: Customizable review criteria and prompts