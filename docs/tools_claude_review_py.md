<!-- Auto-generated by Claude on 2025-06-01 21:17 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can analyze either specific source files or Git diffs, generating structured feedback in Markdown format.

## Purpose

This tool automates the code review process by:
- Analyzing Python source files for bugs, clarity issues, and improvements
- Reviewing Git diffs to provide feedback on code changes
- Generating structured, readable feedback in Markdown format
- Supporting both manual file selection and automatic Git diff analysis

## Requirements

### Dependencies
- `anthropic` - Anthropic's Python client library
- `python-dotenv` - Environment variable management
- `subprocess` - Git command execution (built-in)
- `os`, `sys`, `datetime` - Standard library modules

### Environment Variables
Create a `.env` file with the following variables:
```
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

### Mode 1: Manual File Review
Review specific files by passing them as command-line arguments:
```bash
python claude_review.py file1.py file2.py module/file3.py
```

### Mode 2: Git Diff Review
Review changes in your Git repository (no arguments):
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with proper Markdown code blocks
- Includes file paths as headers

### `get_git_diff()`
Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Behavior:**
- First attempts `git diff origin/main...HEAD`
- Falls back to `git diff HEAD^` if origin/main doesn't exist
- Returns empty string if both fail

### `main()`
Primary execution function that orchestrates the review process.

**Key Steps:**
1. Loads environment variables and initializes Claude client
2. Determines operation mode based on command-line arguments
3. Prepares appropriate prompts for Claude
4. Makes API call to Claude
5. Saves formatted review to `docs/claude_review.md`

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:
- Timestamp of the review
- Structured feedback focusing on:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements  
  - Style consistency

## Error Handling

- **Missing files**: Skipped with warning messages
- **Git errors**: Graceful fallback from `origin/main` to `HEAD^`
- **No diff available**: Creates stub review file
- **API errors**: Displays error message and exits with code 1

## Notes and Suggestions

### Security Considerations
- Store your Anthropic API key securely in the `.env` file
- Add `.env` to your `.gitignore` to prevent accidental commits

### Customization Options
- Modify the `model` variable to use different Claude models
- Adjust `max_tokens` parameter for longer/shorter reviews
- Customize the prompt templates for specific review criteria

### Integration Ideas
- Add this script to your CI/CD pipeline for automated reviews
- Create Git hooks to trigger reviews on commits
- Extend to support other file types beyond Python

### Potential Improvements
- Add support for excluding certain files or directories
- Implement configuration file for custom review criteria
- Add option to append to existing review files instead of overwriting
- Include line number references in reviews for better context

## Example Output Structure

```markdown
# ðŸ§  Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
[Claude's overall assessment]

## Issues Found
- [Specific bugs or problems]

## Suggestions
- [Improvement recommendations]

## Code Quality Notes
- [Style and clarity feedback]
```