<!-- Auto-generated by Claude on 2025-06-02 06:31 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It operates in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes between commits or branches
- **Documentation Generation**: Output structured reviews in Markdown format
- **Development Workflow**: Streamline code review processes in development teams

## Requirements

- Python 3.x
- `anthropic` library
- `python-dotenv` library
- Git (for diff mode)
- Anthropic API key

## Setup

### Environment Variables

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

### Installation

```bash
pip install anthropic python-dotenv
```

## Usage

### Mode 1: File Review

Review specific source files:

```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review

Review Git changes (no arguments):

```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warnings
- Formats code in Markdown code blocks
- Preserves file structure and naming

### `get_git_diff()`

Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Behavior:**
- First attempts: `git diff origin/main...HEAD`
- Fallback: `git diff HEAD^`
- Returns empty string if both fail

### `main()`

Main execution function that orchestrates the review process.

**Process:**
1. Loads environment variables
2. Initializes Anthropic client
3. Determines review mode based on command-line arguments
4. Generates appropriate prompt for Claude
5. Makes API call and processes response
6. Saves formatted review to `docs/claude_review.md`

## Output

The tool generates a Markdown file at `docs/claude_review.md` with:

- **Header**: "ðŸ§  Claude Review"
- **Timestamp**: Last updated time
- **Structured Feedback**: Claude's analysis focusing on:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements
  - Style consistency

## Error Handling

- **Missing Files**: Skips with warning messages
- **Git Errors**: Graceful fallback between diff strategies
- **API Errors**: Exits with error code 1 and descriptive message
- **Missing Dependencies**: Standard Python import errors

## Notes and Suggestions

### Best Practices

- **API Key Security**: Always use environment variables for API keys
- **File Size**: Be mindful of Claude's token limits when reviewing large files
- **Git State**: Ensure your repository is in a clean state before running diff reviews

### Potential Improvements

- **Configuration File**: Add support for custom review criteria
- **Multiple Output Formats**: Support JSON, HTML, or plain text output
- **Batch Processing**: Handle large numbers of files more efficiently
- **Integration**: Add GitHub/GitLab webhook support
- **Caching**: Implement caching to avoid re-reviewing unchanged code

### Limitations

- **Token Limits**: Large diffs or files may exceed Claude's context window
- **Language Support**: Currently optimized for Python (code blocks use Python syntax highlighting)
- **Git Dependency**: Diff mode requires Git to be installed and configured

## Example Output Structure

```markdown
# ðŸ§  Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
Brief overview of the review findings...

## Issues Found
- Critical bug in error handling
- Potential performance concern in loop

## Suggestions
- Consider using list comprehension
- Add type hints for better clarity

## Code Quality
Overall assessment and recommendations...
```