<!-- Auto-generated by Claude on 2025-06-23 06:38 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that provides automated code review functionality using Anthropic's Claude AI model. The tool can operate in two modes: reviewing specific source files or analyzing Git diffs. It outputs structured feedback in a Markdown format for easy integration into documentation workflows.

## Purpose

- **Automated Code Review**: Leverage Claude AI to provide consistent, structured code review feedback
- **Flexible Input**: Support both manual file specification and Git diff analysis
- **Documentation Integration**: Generate Markdown output suitable for project documentation
- **Development Workflow**: Streamline code review processes in development pipelines

## Requirements

### Dependencies
- `anthropic` - Anthropic API client
- `python-dotenv` - Environment variable management
- `subprocess` - Git command execution
- Standard library modules: `os`, `sys`, `datetime`

### Environment Variables
- `ANTHROPIC_API_KEY` (required) - Your Anthropic API key
- `ANTHROPIC_MODEL` (optional) - Claude model to use (defaults to `claude-sonnet-4-20250514`)

## Usage

### Mode 1: Manual File Review
```bash
python claude_review.py file1.py file2.py [additional_files...]
```

### Mode 2: Git Diff Review
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warning messages
- Formats each file with appropriate Markdown code blocks
- Assumes Python syntax highlighting (may need adjustment for other languages)

### `get_git_diff()`
Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. First attempts: `git diff origin/main...HEAD`
2. Falls back to: `git diff HEAD^`
3. Returns empty string if both fail

### `main()`
Main execution function that orchestrates the review process.

**Workflow:**
1. Loads environment variables and initializes Claude client
2. Creates output directory structure
3. Determines operation mode based on command-line arguments
4. Generates appropriate prompt for Claude
5. Makes API call and processes response
6. Saves formatted output to Markdown file

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:

- **Header**: "üß† Claude Review" with timestamp
- **Review Content**: Structured feedback from Claude focusing on:
  - Bugs or logic issues
  - Code clarity and readability
  - Suggested improvements
  - Style consistency

## Error Handling

- **Missing Files**: Skipped with warning messages
- **Git Command Failures**: Graceful fallback to alternative commands
- **No Diff Available**: Generates stub review file
- **API Errors**: Exits with error code 1 and descriptive message

## Notes and Suggestions

### ‚ö†Ô∏è Important Considerations

1. **API Key Security**: Ensure your `ANTHROPIC_API_KEY` is properly secured and not committed to version control

2. **Token Limits**: Current max_tokens is set to 1500, which may be insufficient for large diffs or multiple files

3. **Language Assumption**: Code blocks are hardcoded with Python syntax highlighting

### üîß Potential Improvements

1. **Language Detection**: Dynamically detect file types for appropriate syntax highlighting
   ```python
   # Example enhancement
   def get_language(file_path):
       extension_map = {'.py': 'python', '.js': 'javascript', '.java': 'java'}
       return extension_map.get(os.path.splitext(file_path)[1], 'text')
   ```

2. **Configurable Token Limits**: Make max_tokens configurable based on input size

3. **Output Format Options**: Support multiple output formats (HTML, plain text, etc.)

4. **Batch Processing**: Add support for directory traversal and batch file processing

5. **Custom Prompts**: Allow custom review criteria through configuration files

### üí° Usage Tips

- **Pre-commit Integration**: Consider integrating into pre-commit hooks for automated reviews
- **CI/CD Pipeline**: Use in continuous integration for pull request reviews
- **Documentation**: The generated Markdown integrates well with documentation sites
- **Review History**: Consider adding version control for review history tracking

## Example Environment Setup

Create a `.env` file in your project root:
```bash
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514
```