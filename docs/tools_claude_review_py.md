<!-- Auto-generated by Claude on 2025-06-21 21:17 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It supports two main modes of operation:

1. **Manual File Review**: Reviews specific source files provided as command-line arguments
2. **Git Diff Review**: Reviews changes in a Git repository by analyzing the diff between branches or commits

The tool outputs structured feedback in Markdown format, making it easy to integrate into development workflows and documentation systems.

## Purpose

- Automate code review processes using AI
- Provide consistent, structured feedback on code quality
- Support both individual file reviews and Git-based change reviews
- Generate documentation-ready output in Markdown format

## Requirements

- Python 3.x
- Required packages:
  - `anthropic` - Claude AI API client
  - `python-dotenv` - Environment variable management
- Environment variables:
  - `ANTHROPIC_API_KEY` - Your Anthropic API key (required)
  - `ANTHROPIC_MODEL` - Claude model to use (optional, defaults to "claude-sonnet-4-20250514")

## Installation

```bash
pip install anthropic python-dotenv
```

Create a `.env` file in your project root:
```
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # optional
```

## Usage

### Manual File Review
```bash
python claude_review.py file1.py file2.py file3.py
```

### Git Diff Review
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string for review.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warning messages
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting (may need adjustment for other languages)

### `get_git_diff()`

Retrieves Git diff output using multiple fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. First attempts: `git diff origin/main...HEAD`
2. If failed, tries: `git diff HEAD^`
3. Returns empty string if both fail

### `main()`

Primary execution function that orchestrates the entire review process.

**Key Responsibilities:**
- Environment setup and API client initialization
- Command-line argument processing
- Mode selection (file review vs. git diff)
- Claude API interaction
- Output file generation

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:

- **Header**: "üß† Claude Review" with timestamp
- **Structured Feedback**: Claude's analysis focusing on:
  - Bugs or logic issues
  - Code clarity and readability
  - Suggested improvements
  - Style consistency

## Configuration

### Environment Variables

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `ANTHROPIC_API_KEY` | Yes | None | Your Anthropic API key |
| `ANTHROPIC_MODEL` | No | `claude-sonnet-4-20250514` | Claude model to use |

### API Parameters

- **Max Tokens**: 1500 (may need adjustment for larger codebases)
- **Model**: Configurable via environment variable

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Gracefully falls back through different diff strategies
- **API Errors**: Exits with error code 1 and descriptive message
- **No Diff Available**: Creates stub review file instead of failing

## Notes and Suggestions

### üîß Potential Improvements

1. **Language Detection**: Currently assumes Python syntax highlighting
   ```python
   # Consider adding language detection
   def detect_language(file_path):
       extension = os.path.splitext(file_path)[1]
       language_map = {'.py': 'python', '.js': 'javascript', '.java': 'java'}
       return language_map.get(extension, 'text')
   ```

2. **Token Limit Management**: For large codebases, implement chunking
3. **Custom Prompts**: Allow customization of review criteria
4. **Multiple Output Formats**: Support JSON, HTML, or plain text output

### ‚ö†Ô∏è Limitations

- **File Size**: Limited by Claude's token limits (1500 max tokens configured)
- **Language Support**: Hardcoded for Python syntax highlighting
- **Git Dependency**: Git diff mode requires Git repository and proper branch setup

### üöÄ Integration Tips

- **CI/CD Integration**: Can be integrated into GitHub Actions or similar workflows
- **Pre-commit Hooks**: Useful as a pre-commit or pre-push hook
- **Documentation**: Generated Markdown integrates well with documentation systems

### üí° Best Practices

- Keep API key secure and never commit to version control
- Test with small files first to understand output format
- Review and validate AI suggestions before implementing changes
- Consider rate limiting for large-scale usage