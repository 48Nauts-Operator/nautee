<!-- Auto-generated by Claude on 2025-06-22 12:38 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can analyze either specific source files or Git diffs, providing structured feedback in Markdown format.

## Purpose

This tool automates the code review process by:
- Analyzing source code for bugs, logic issues, and improvements
- Reviewing Git diffs for changes between commits
- Generating structured, readable feedback in Markdown format
- Integrating AI-powered code analysis into development workflows

## Features

- **Dual Mode Operation**: Review specific files or Git diffs
- **Markdown Output**: Generates well-formatted documentation
- **Git Integration**: Automatically detects and analyzes code changes
- **Error Handling**: Gracefully handles missing files and Git errors
- **Configurable**: Uses environment variables for API configuration

## Installation & Setup

### Prerequisites

- Python 3.6+
- Anthropic API key
- Git (for diff mode)

### Required Dependencies

```bash
pip install anthropic python-dotenv
```

### Environment Configuration

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

### Mode 1: File Review

Review specific source files:

```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review

Review Git changes (no arguments):

```bash
python claude_review.py
```

The tool will attempt to get diff using:
1. `git diff origin/main...HEAD` (preferred)
2. `git diff HEAD^` (fallback)

## Key Functions

### `load_code(file_paths)`

**Purpose**: Combines multiple source files into a single Markdown-formatted string.

**Parameters**:
- `file_paths` (list): List of file paths to process

**Returns**: 
- `str`: Markdown-formatted string containing all file contents

**Features**:
- Skips missing files with warning messages
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting

### `get_git_diff()`

**Purpose**: Retrieves Git diff output with fallback options.

**Returns**: 
- `str`: Git diff string or empty string if unavailable

**Behavior**:
- First tries `git diff origin/main...HEAD`
- Falls back to `git diff HEAD^` if origin/main doesn't exist
- Returns empty string if both fail

### `main()`

**Purpose**: Main execution function that orchestrates the review process.

**Key Operations**:
- Loads environment variables and initializes Claude client
- Determines operation mode based on command-line arguments
- Constructs appropriate prompts for Claude
- Handles API communication and error management
- Saves output to `docs/claude_review.md`

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:

- **Header**: "ðŸ§  Claude Review" with timestamp
- **Structured Feedback**: AI-generated analysis focusing on:
  - Bugs or logic issues
  - Code clarity and readability
  - Suggested improvements
  - Style consistency

## Error Handling

The script includes robust error handling for:

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Tries multiple Git diff strategies
- **API Errors**: Catches and reports Claude API issues
- **No Changes**: Creates stub review when no diff is available

## Notes and Suggestions

### Best Practices

- **API Key Security**: Keep your `ANTHROPIC_API_KEY` secure and never commit it to version control
- **File Size**: Be mindful of file sizes as they count toward Claude's token limits
- **Review Quality**: The AI feedback is a starting point; human review is still recommended

### Limitations

- **Language Assumption**: Currently assumes Python syntax highlighting for all files
- **Token Limits**: Large diffs or files may exceed Claude's token limits (max_tokens=1500)
- **File Types**: Works best with text-based source files

### Potential Improvements

- Add support for multiple programming languages
- Implement file size checks before processing
- Add configuration options for different review focuses
- Include support for custom output paths
- Add batch processing capabilities

### Integration Ideas

- **CI/CD Integration**: Run as part of pull request workflows
- **Pre-commit Hooks**: Integrate with Git hooks for automatic reviews
- **IDE Extensions**: Develop plugins for popular IDEs
- **Team Workflows**: Use in code review processes alongside human reviewers