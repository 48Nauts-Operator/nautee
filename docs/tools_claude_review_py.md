<!-- Auto-generated by Claude on 2025-06-22 06:34 -->

# Claude Review Tool

A Python script that leverages Anthropic's Claude API to perform automated code reviews on either specific source files or Git diffs, generating structured Markdown feedback.

## Purpose

This tool automates the code review process by:
- Analyzing individual Python files or Git diffs
- Providing structured feedback on bugs, code clarity, and improvements
- Generating a readable Markdown report with review findings
- Supporting both manual file selection and automatic Git diff analysis

## Features

- **Dual Mode Operation**: Review specific files or analyze Git diffs automatically
- **Markdown Output**: Generates clean, structured documentation in `docs/claude_review.md`
- **Git Integration**: Intelligently handles different Git scenarios (origin/main, HEAD^)
- **Error Handling**: Gracefully handles missing files and API errors
- **Configurable Model**: Supports different Claude model versions via environment variables

## Dependencies

```python
import os
import sys
import anthropic
from dotenv import load_dotenv
from datetime import datetime
import subprocess
```

**Required packages:**
- `anthropic` - Claude API client
- `python-dotenv` - Environment variable management

## Environment Setup

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_claude_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Core Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file as a separate code block
- Handles file reading errors gracefully

### `get_git_diff()`

Retrieves Git diff output using fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. First attempts: `git diff origin/main...HEAD`
2. If failed, tries: `git diff HEAD^`
3. Returns empty string if both fail

## Usage

### Mode 1: Manual File Review

Review specific files by passing them as command-line arguments:

```bash
python claude_review.py file1.py file2.py module/file3.py
```

### Mode 2: Git Diff Review

Run without arguments to automatically review the current Git diff:

```bash
python claude_review.py
```

## Output

The tool generates `docs/claude_review.md` with:

- **Header**: "ðŸ§  Claude Review" with timestamp
- **Structured Feedback**: Claude's analysis focusing on:
  - Bugs or logic issues
  - Code clarity and readability
  - Suggested improvements
  - Style consistency
- **Markdown Formatting**: Clean, readable structure with proper headings and code blocks

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Falls back to alternative diff strategies
- **API Errors**: Exits gracefully with error messages
- **No Diff Available**: Creates stub review document

## Notes and Suggestions

### Best Practices

- **API Key Security**: Never commit your `.env` file to version control
- **File Size Limits**: Be mindful of Claude's token limits when reviewing large files
- **Git Workflow**: Works best with feature branch workflows where `origin/main` exists

### Potential Improvements

- Add support for other file types beyond Python
- Implement configuration file for custom review criteria
- Add option to append reviews instead of overwriting
- Include file size validation before API calls
- Add support for custom output paths

### Limitations

- **Token Limits**: Large diffs may exceed Claude's context window
- **File Type Assumption**: Currently assumes Python files for syntax highlighting
- **Git Dependency**: Requires Git repository for diff mode
- **Single Output**: Always overwrites the same output file

## Example Output Structure

```markdown
# ðŸ§  Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
Brief overview of the code review findings...

## Issues Found
- **Bug**: Description of potential bug
- **Style**: Inconsistency noted

## Suggestions
1. Recommended improvement 1
2. Recommended improvement 2

## Code Quality
Overall assessment of the code quality...
```