<!-- Auto-generated by Claude on 2025-06-08 07:18 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes in Git diffs automatically
- **Structured Output**: Generate consistent, readable Markdown documentation
- **Development Workflow**: Integrate AI reviews into CI/CD pipelines or local development

## Requirements

### Dependencies
- `anthropic` - Claude AI API client
- `python-dotenv` - Environment variable management
- `subprocess` - Git command execution
- Standard library modules: `os`, `sys`, `datetime`

### Environment Variables
- `ANTHROPIC_API_KEY` - Your Anthropic API key (required)
- `ANTHROPIC_MODEL` - Claude model to use (optional, defaults to `claude-sonnet-4-20250514`)

## Usage Modes

### Mode 1: File Review
Review specific source files by passing them as command-line arguments:

```bash
python claude_review.py file1.py file2.py module/file3.py
```

### Mode 2: Git Diff Review
Review Git changes by running without arguments:

```bash
python claude_review.py
```

The tool will attempt to get diffs in this order:
1. `git diff origin/main...HEAD`
2. `git diff HEAD^` (fallback)

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file as a separate code block
- Handles file reading errors gracefully

### `get_git_diff()`
Retrieves Git diff output using subprocess commands.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Behavior:**
- First tries `git diff origin/main...HEAD`
- Falls back to `git diff HEAD^` if origin/main doesn't exist
- Returns empty string if both commands fail

### `main()`
Main execution function that orchestrates the review process.

**Workflow:**
1. Load environment variables and initialize Claude client
2. Create output directory (`docs/`)
3. Determine review mode based on command-line arguments
4. Generate appropriate prompt for Claude
5. Call Claude API and save formatted results

## Output

### File Structure
```
docs/
â””â”€â”€ claude_review.md
```

### Output Format
```markdown
# ðŸ§  Claude Review

_Last updated: YYYY-MM-DD HH:MM_

[Claude's structured feedback]
```

## Configuration

### Environment Setup
Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514
```

### Model Options
- `claude-sonnet-4-20250514` (default)
- Other Claude models as available from Anthropic

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Graceful fallback between git diff commands
- **API Errors**: Exits with error code 1 and descriptive message
- **No Diff Available**: Creates stub review file when no changes found

## Notes and Suggestions

### Best Practices
- **API Key Security**: Never commit your `.env` file to version control
- **Token Limits**: Current limit is 1500 tokens - adjust based on your needs
- **File Types**: While designed for Python, can review any text-based files

### Integration Ideas
- **Pre-commit Hooks**: Run reviews before commits
- **CI/CD Pipeline**: Integrate into GitHub Actions or similar
- **IDE Integration**: Create editor plugins for on-demand reviews

### Limitations
- **Token Limit**: Large files or diffs may be truncated
- **API Dependency**: Requires internet connection and valid API key
- **Git Dependency**: Git diff mode requires a Git repository

### Potential Improvements
- Add support for different output formats (HTML, JSON)
- Implement file type detection and language-specific prompts
- Add configuration file support for custom review criteria
- Include diff statistics and change summaries

## Example Usage

```bash
# Review specific Python files
python claude_review.py src/main.py tests/test_main.py

# Review current Git changes
python claude_review.py

# Check the generated review
cat docs/claude_review.md
```