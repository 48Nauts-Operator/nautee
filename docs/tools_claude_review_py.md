<!-- Auto-generated by Claude on 2025-06-01 12:38 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool outputs structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes in Git diffs automatically
- **Documentation Generation**: Outputs structured Markdown reports for easy sharing and archiving
- **Development Workflow Integration**: Can be integrated into CI/CD pipelines or used as a standalone tool

## Installation & Setup

### Prerequisites

- Python 3.6+
- Git (for diff mode)
- Anthropic API key

### Required Dependencies

```bash
pip install anthropic python-dotenv
```

### Environment Configuration

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

### Mode 1: File Review

Review specific source files:

```bash
python claude_review.py file1.py file2.py module/file3.py
```

### Mode 2: Git Diff Review

Review Git changes (no arguments):

```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`

**Purpose**: Combines multiple source files into a single markdown-formatted string for review.

**Parameters**:
- `file_paths` (list): List of file paths to process

**Returns**: 
- `str`: Markdown-formatted string containing all file contents

**Features**:
- Handles missing files gracefully with warnings
- Formats code in markdown code blocks
- Preserves file path information

### `get_git_diff()`

**Purpose**: Retrieves Git diff output with fallback strategies.

**Returns**:
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy**:
1. First tries: `git diff origin/main...HEAD`
2. Falls back to: `git diff HEAD^`
3. Returns empty string if both fail

### `main()`

**Purpose**: Main execution function that orchestrates the entire review process.

**Key Responsibilities**:
- Environment setup and API client initialization
- Mode detection (file review vs. git diff)
- Claude API interaction
- Output file generation

## Output

### Generated Files

- **Location**: `docs/claude_review.md`
- **Format**: Structured Markdown with timestamp
- **Content**: AI-generated code review feedback

### Review Focus Areas

The tool instructs Claude to focus on:

- üêõ **Bugs or logic issues**
- üìñ **Code clarity and readability**
- üí° **Suggested improvements**
- üé® **Style consistency**

## Configuration Options

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `ANTHROPIC_API_KEY` | Your Anthropic API key | **Required** |
| `ANTHROPIC_MODEL` | Claude model to use | `claude-sonnet-4-20250514` |

### API Parameters

- **Max Tokens**: 1,500 (configurable in code)
- **Model**: Configurable via environment variable

## Error Handling

### Robust Error Management

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Graceful fallback between different git diff strategies
- **API Errors**: Clear error messages with non-zero exit codes
- **No Changes**: Creates stub review when no diff is available

## Integration Suggestions

### CI/CD Integration

```yaml
# Example GitHub Actions step
- name: Run Claude Review
  run: python claude_review.py
  env:
    ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
```

### Pre-commit Hook

```bash
#!/bin/sh
python claude_review.py
git add docs/claude_review.md
```

## Notes and Recommendations

### üîí Security Considerations

- Store API keys securely using environment variables
- Consider API rate limits for large codebases
- Be mindful of sending sensitive code to external APIs

### üöÄ Performance Tips

- The tool is optimized for moderate-sized diffs and files
- For large codebases, consider reviewing specific modules
- Monitor API token usage with the 1,500 token limit

### üõ† Customization Options

- Modify the prompt in `main()` to focus on specific review criteria
- Adjust `max_tokens` for longer or shorter reviews
- Change output format or location as needed

### üìã Best Practices

- Run reviews on feature branches before merging
- Use file mode for focused reviews of specific components
- Combine with existing code review processes rather than replacing them
- Regularly update the Claude model version for improved performance