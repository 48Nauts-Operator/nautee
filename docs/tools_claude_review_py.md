<!-- Auto-generated by Claude on 2025-06-01 20:21 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that automates code review using Anthropic's Claude AI. It can analyze either specific source files or Git diffs, providing structured feedback in Markdown format.

## Purpose

This tool helps developers get AI-powered code reviews by:
- Analyzing specified Python files for bugs, clarity, and style issues
- Reviewing Git diffs to provide feedback on code changes
- Generating structured Markdown reports for documentation

## Features

- **Dual Mode Operation**: Manual file review or automatic Git diff analysis
- **Markdown Output**: Generates structured, readable review reports
- **Git Integration**: Automatically detects and analyzes code changes
- **Error Handling**: Gracefully handles missing files and Git errors

## Requirements

### Dependencies
- `anthropic` - Claude API client
- `python-dotenv` - Environment variable management
- `subprocess` - Git command execution

### Environment Variables
Create a `.env` file with:
```bash
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

### Mode 1: Manual File Review
```bash
python claude_review.py file1.py file2.py file3.py
```
Reviews specific files and combines their content for analysis.

### Mode 2: Git Diff Review
```bash
python claude_review.py
```
Automatically analyzes changes between branches or commits.

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to analyze

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warnings
- Formats code in markdown code blocks
- Preserves file structure and naming

### `get_git_diff()`
Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. Tries `git diff origin/main...HEAD`
2. Falls back to `git diff HEAD^`
3. Returns empty string if both fail

### `main()`
Primary execution function that orchestrates the review process.

**Key Steps:**
1. Loads environment variables and initializes Claude client
2. Determines review mode based on command-line arguments
3. Prepares appropriate prompts for Claude
4. Makes API call and processes response
5. Saves formatted review to `docs/claude_review.md`

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:
- Timestamp of the review
- Structured feedback focusing on:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements
  - Style consistency

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Tries multiple diff strategies before giving up
- **API Errors**: Exits gracefully with error messages
- **No Changes**: Creates stub review when no diff is available

## Notes and Suggestions

### Best Practices
- Ensure your `ANTHROPIC_API_KEY` is properly set
- Run from your project root directory for optimal Git integration
- Review the generated Markdown file in your preferred viewer

### Limitations
- Currently optimized for Python files (though can handle other text files)
- Limited to 1500 tokens for Claude responses
- Requires Git repository for diff mode

### Potential Improvements
- Add support for multiple programming languages
- Implement configurable token limits
- Add integration with other version control systems
- Include code metrics and complexity analysis

## File Structure

The script automatically creates:
```
project/
├── docs/
│   └── claude_review.md    # Generated review output
├── .env                    # Environment variables
└── claude_review.py        # The script itself
```