<!-- Auto-generated by Claude on 2025-06-01 22:18 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can analyze either specific source files or Git diffs, providing structured feedback in Markdown format.

## Purpose

This tool is designed to:
- Automate code review processes using AI
- Generate consistent, structured feedback in Markdown format
- Support both manual file review and Git diff analysis
- Integrate with development workflows for continuous code quality improvement

## Features

- **Dual Operation Modes**: Review specific files or analyze Git diffs
- **Structured Output**: Generates clean Markdown documentation
- **Git Integration**: Automatically detects and analyzes code changes
- **Error Handling**: Gracefully handles missing files and Git operations
- **Configurable**: Uses environment variables for API configuration

## Dependencies

```python
import os
import sys
import anthropic
from dotenv import load_dotenv
from datetime import datetime
import subprocess
```

Required packages:
- `anthropic` - Claude AI API client
- `python-dotenv` - Environment variable management

## Environment Variables

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_claude_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

### Mode 1: Manual File Review
```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review
```bash
python claude_review.py
```
*(No arguments - automatically analyzes Git diff)*

## Key Functions

### `load_code(file_paths)`
- **Purpose**: Combines multiple source files into a single Markdown-formatted string
- **Parameters**: 
  - `file_paths` (list): List of file paths to process
- **Returns**: Markdown-formatted string containing all file contents
- **Error Handling**: Skips missing files with warning messages

### `get_git_diff()`
- **Purpose**: Retrieves Git diff output for review
- **Strategy**: 
  1. First attempts `git diff origin/main...HEAD`
  2. Falls back to `git diff HEAD^` if origin/main unavailable
- **Returns**: Git diff string or empty string if unavailable
- **Error Handling**: Graceful fallback with user feedback

### `main()`
- **Purpose**: Main execution function coordinating the entire review process
- **Workflow**:
  1. Initialize Claude client and configuration
  2. Determine operation mode based on command-line arguments
  3. Prepare appropriate prompt for Claude
  4. Execute API call and save results

## Output

The tool generates a structured Markdown file at `docs/claude_review.md` containing:

- **Header**: "üß† Claude Review" with timestamp
- **Structured Feedback**: 
  - Bugs or logic issues
  - Code clarity assessment
  - Suggested improvements
  - Style consistency notes

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Operations**: Provides fallback strategies for different Git configurations
- **API Errors**: Catches and reports Claude API failures
- **No Diff Available**: Creates stub review file when no changes detected

## Notes and Suggestions

### üîß Configuration
- Ensure your `ANTHROPIC_API_KEY` is properly set in the `.env` file
- Consider adjusting the `max_tokens` parameter (currently 1500) based on your needs

### üöÄ Integration Tips
- Add this tool to your CI/CD pipeline for automated reviews
- Use as a pre-commit hook for immediate feedback
- Combine with existing code review processes

### ‚ö†Ô∏è Limitations
- Currently hardcoded for Python files (see `load_code` function)
- Fixed output location (`docs/claude_review.md`)
- Limited to 1500 tokens for Claude responses

### üîÑ Potential Improvements
- Add support for multiple programming languages
- Make output path configurable
- Implement recursive directory scanning
- Add configuration file support for custom review criteria
- Include file type detection and appropriate syntax highlighting

### üìÅ File Structure
```
project/
‚îú‚îÄ‚îÄ .env                    # Environment variables
‚îú‚îÄ‚îÄ claude_review.py        # Main script
‚îî‚îÄ‚îÄ docs/
    ‚îî‚îÄ‚îÄ claude_review.md    # Generated review output
```