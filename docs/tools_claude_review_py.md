<!-- Auto-generated by Claude on 2025-06-23 04:34 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that automates code review using Anthropic's Claude AI. It provides structured feedback on code by analyzing either specific source files or Git diffs, outputting results in a well-formatted Markdown file.

## Purpose

- **Automated Code Review**: Leverage Claude AI to provide consistent, structured code feedback
- **Flexible Input**: Support both manual file specification and Git diff analysis
- **Documentation Output**: Generate readable Markdown reports for easy sharing and reference
- **CI/CD Integration**: Can be integrated into development workflows for automated reviews

## Features

- üîç **Dual Review Modes**: Manual file review or Git diff analysis
- üìù **Markdown Output**: Clean, structured feedback in Markdown format
- üõ°Ô∏è **Error Handling**: Graceful handling of missing files and Git operations
- ‚öôÔ∏è **Configurable**: Environment-based configuration for API keys and models

## Installation & Setup

### Prerequisites

```bash
pip install anthropic python-dotenv
```

### Environment Configuration

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

### Mode 1: Manual File Review

Review specific files by passing them as command-line arguments:

```bash
python claude_review.py file1.py file2.py module/file3.py
```

### Mode 2: Git Diff Review

Run without arguments to review Git changes:

```bash
python claude_review.py
```

The script will attempt to get diff using:
1. `git diff origin/main...HEAD` (preferred)
2. `git diff HEAD^` (fallback)

## Core Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting

### `get_git_diff()`

Retrieves Git diff output with fallback mechanisms.

**Returns:**
- `str`: Git diff output or empty string if unavailable

**Behavior:**
- First attempts `git diff origin/main...HEAD`
- Falls back to `git diff HEAD^` if origin/main doesn't exist
- Returns empty string if both methods fail

### `main()`

Main execution function that orchestrates the review process:

1. **Setup Phase**: Loads environment variables and initializes Claude client
2. **Mode Detection**: Determines whether to review files or Git diff
3. **Content Processing**: Prepares appropriate prompts for Claude
4. **API Interaction**: Sends request to Claude and processes response
5. **Output Generation**: Writes formatted review to Markdown file

## Output

Reviews are saved to `docs/claude_review.md` with the following structure:

```markdown
# üß† Claude Review

_Last updated: 2024-01-15 14:30_

[Claude's structured feedback here]
```

## Configuration Options

| Environment Variable | Default Value | Description |
|---------------------|---------------|-------------|
| `ANTHROPIC_API_KEY` | *Required* | Your Anthropic API key |
| `ANTHROPIC_MODEL` | `claude-sonnet-4-20250514` | Claude model to use |

## Error Handling

The script includes robust error handling for common scenarios:

- **Missing Files**: Warns and skips non-existent files
- **Git Operations**: Graceful fallback when Git commands fail
- **API Errors**: Catches and reports Claude API issues
- **No Changes**: Creates stub review when no diff is available

## Integration Suggestions

### Pre-commit Hook

Add to `.git/hooks/pre-commit`:

```bash
#!/bin/bash
python claude_review.py
```

### GitHub Actions

```yaml
- name: Run Claude Review
  run: |
    python claude_review.py
    git add docs/claude_review.md
```

### Development Workflow

```bash
# Review specific changes
python claude_review.py src/modified_file.py

# Review all staged changes
git add . && python claude_review.py
```

## Limitations & Notes

- **API Dependency**: Requires active Anthropic API key and internet connection
- **Token Limits**: Limited to 1500 tokens per review (configurable in code)
- **Language Assumption**: Code blocks assume Python syntax highlighting
- **File Encoding**: Assumes UTF-8 encoding for source files
- **Git Dependency**: Git diff mode requires Git repository context

## Future Enhancements

- Support for multiple programming languages
- Configurable output formats (HTML, PDF)
- Integration with popular code review platforms
- Batch processing for large repositories
- Custom review criteria configuration