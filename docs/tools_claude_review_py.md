<!-- Auto-generated by Claude on 2025-06-22 21:18 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that provides automated code review functionality using Anthropic's Claude API. It can review code in two modes: analyzing specific source files or reviewing Git diffs. The tool outputs structured feedback as a Markdown file.

## Purpose

- **Automated Code Review**: Leverage Claude AI to provide code review feedback
- **Flexible Input**: Support both file-based and Git diff-based reviews
- **Structured Output**: Generate consistent, readable Markdown documentation
- **CI/CD Integration**: Can be integrated into development workflows

## Requirements

### Dependencies
- `anthropic` - Anthropic's Python client library
- `python-dotenv` - Environment variable management
- `subprocess` - Git command execution (built-in)
- `os`, `sys`, `datetime` - Standard library modules

### Environment Variables
Create a `.env` file with:
```bash
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
```

## Usage

### Mode 1: File Review
Review specific source files:
```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review
Review changes in the current Git repository:
```bash
python claude_review.py
```

## Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warnings
- Formats code with proper syntax highlighting
- Creates organized sections for each file

### `get_git_diff()`
Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. First attempts: `git diff origin/main...HEAD`
2. Falls back to: `git diff HEAD^`
3. Returns empty string if both fail

### `main()`
Main execution function that orchestrates the review process.

**Workflow:**
1. Load environment variables and initialize Claude client
2. Determine review mode based on command-line arguments
3. Prepare appropriate prompt for Claude
4. Make API call and process response
5. Save formatted output to `docs/claude_review.md`

## Output

The tool generates a Markdown file at `docs/claude_review.md` with:
- Timestamp header
- Structured feedback from Claude
- Focus areas include:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements
  - Style consistency

## Error Handling

### Robust File Handling
- Skips missing files with warning messages
- Continues processing remaining files

### Git Operation Fallbacks
- Multiple Git diff strategies
- Graceful degradation when Git operations fail

### API Error Management
- Catches and reports Claude API errors
- Exits cleanly with appropriate error codes

## Notes and Suggestions

### Security Considerations
- ⚠️ **API Key Security**: Ensure `.env` file is in `.gitignore`
- Consider using environment variables in production environments

### Customization Options
- Modify the `model` variable to use different Claude versions
- Adjust `max_tokens` parameter based on expected response length
- Customize the prompt templates for specific review criteria

### Integration Tips
- **CI/CD**: Can be integrated into GitHub Actions or other CI systems
- **Pre-commit Hooks**: Consider adding as a git pre-commit hook
- **Batch Processing**: Supports multiple files for comprehensive reviews

### Limitations
- **Token Limits**: Large codebases may exceed Claude's token limits
- **Git Dependency**: Diff mode requires a Git repository
- **File Type**: Currently optimized for Python files (hardcoded syntax highlighting)

### Recommended Improvements
1. Add support for different programming languages
2. Implement configuration file support
3. Add options for different output formats
4. Include code metrics in reviews
5. Add support for custom review templates

## File Structure
```
project/
├── claude_review.py          # Main script
├── .env                      # Environment variables (create this)
├── docs/
│   └── claude_review.md     # Generated output
└── requirements.txt         # Dependencies (recommended)
```