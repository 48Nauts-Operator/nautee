<!-- Auto-generated by Claude on 2025-06-23 05:22 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can analyze either specific source files or Git diffs, providing structured feedback in Markdown format.

## Purpose

This tool helps developers:
- Get AI-powered code reviews for quality assurance
- Analyze Git diffs before merging changes
- Receive structured feedback on code clarity, bugs, and improvements
- Generate consistent, documented review outputs

## Features

- **Dual Operation Modes**: Review specific files or Git diffs
- **Markdown Output**: Generates structured, readable review documents
- **Git Integration**: Automatically fetches diffs from version control
- **Flexible Model Selection**: Configurable Claude model via environment variables
- **Error Handling**: Graceful handling of missing files and Git errors

## Dependencies

```python
import os
import sys
import anthropic
from dotenv import load_dotenv
from datetime import datetime
import subprocess
```

**Required packages:**
- `anthropic` - Claude API client
- `python-dotenv` - Environment variable management

## Setup

### Environment Variables

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
```

### Installation

```bash
pip install anthropic python-dotenv
```

## Usage

### Mode 1: File Review
Review specific source files:

```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review
Review Git changes (no arguments):

```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warnings
- Formats each file as a code block with syntax highlighting
- Handles file reading errors gracefully

### `get_git_diff()`

Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Behavior:**
- First attempts: `git diff origin/main...HEAD`
- Fallback: `git diff HEAD^` if origin/main doesn't exist
- Returns empty string if both fail

### `main()`

Main execution function that orchestrates the review process.

**Key Steps:**
1. Loads environment configuration
2. Determines operation mode (file review vs. diff review)
3. Prepares appropriate prompts for Claude
4. Makes API call to Claude
5. Saves formatted output to `docs/claude_review.md`

## Output

The tool generates a Markdown file at `docs/claude_review.md` with:

- **Header**: "ðŸ§  Claude Review" 
- **Timestamp**: Last updated information
- **Structured Feedback**: Claude's analysis focusing on:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements
  - Style consistency

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Falls back to alternative diff strategies
- **API Errors**: Exits gracefully with error messages
- **No Diff Available**: Creates stub review document

## Notes and Suggestions

### Best Practices

- **API Key Security**: Keep your Anthropic API key in `.env` and never commit it
- **Model Selection**: The default model may change; specify explicitly for consistency
- **File Size Limits**: Large files may exceed Claude's token limits
- **Git Integration**: Ensure you're in a Git repository for diff mode

### Potential Improvements

- Add support for multiple programming languages beyond Python
- Implement configurable output directories
- Add support for custom review criteria
- Include file size validation before API calls
- Add support for reviewing specific Git commit ranges

### Limitations

- **Token Limits**: Large diffs or files may exceed Claude's context window
- **Language Detection**: Currently assumes Python syntax highlighting
- **Git Dependency**: Diff mode requires Git repository context
- **Network Dependency**: Requires internet connection for Claude API

## Example Output Structure

```markdown
# ðŸ§  Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
[Claude's overall assessment]

## Issues Found
- [Specific bugs or problems]

## Suggestions
- [Improvement recommendations]

## Code Quality Notes
- [Style and clarity feedback]
```