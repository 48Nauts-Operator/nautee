<!-- Auto-generated by Claude on 2025-06-01 16:23 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes in Git diffs automatically
- **Documentation Generation**: Output structured reviews in Markdown format
- **Development Workflow**: Integrate AI code review into CI/CD pipelines or local development

## Requirements

### Dependencies
- `anthropic` - Claude API client
- `python-dotenv` - Environment variable management
- `subprocess` - Git command execution
- `os`, `sys`, `datetime` - Standard Python libraries

### Environment Variables
- `ANTHROPIC_API_KEY` - Required API key for Claude access
- `ANTHROPIC_MODEL` - Optional model specification (defaults to `claude-sonnet-4-20250514`)

## Usage Modes

### Mode 1: Manual File Review
```bash
python claude_review.py file1.py file2.py file3.py
```
Reviews specified source files directly.

### Mode 2: Git Diff Review
```bash
python claude_review.py
```
Reviews Git changes automatically (no file arguments).

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warnings
- Formats code with syntax highlighting
- Preserves file structure and naming

### `get_git_diff()`
Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Git Strategies:**
1. Tries `git diff origin/main...HEAD` first
2. Falls back to `git diff HEAD^` if origin/main doesn't exist
3. Returns empty string if both fail

### `main()`
Orchestrates the entire review process including:
- Environment setup and API client initialization
- Mode detection (file review vs. git diff)
- Claude API interaction
- Output file generation

## Output

### File Location
- **Path**: `docs/claude_review.md`
- **Auto-created**: Creates `docs/` directory if it doesn't exist

### Content Structure
```markdown
# ðŸ§  Claude Review

_Last updated: YYYY-MM-DD HH:MM_

[Claude's review feedback here]
```

## Review Focus Areas

The tool instructs Claude to focus on:
- **Bugs or logic issues** - Potential runtime errors or logical flaws
- **Code clarity** - Readability and maintainability concerns  
- **Suggested improvements** - Optimization and best practice recommendations
- **Style consistency** - Coding standard adherence

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Graceful fallback between Git diff strategies
- **API Errors**: Catches and reports Claude API failures
- **No Changes**: Creates stub review when no diff is available

## Configuration Notes

### API Limits
- **Max Tokens**: Set to 1500 (configurable in code)
- **Model**: Defaults to `claude-sonnet-4-20250514`

### File Assumptions
- Assumes Python files (`.py` extension in syntax highlighting)
- Works with any text-based source files

## Setup Instructions

1. **Install Dependencies**:
   ```bash
   pip install anthropic python-dotenv
   ```

2. **Environment Configuration**:
   ```bash
   # Create .env file
   echo "ANTHROPIC_API_KEY=your_api_key_here" > .env
   ```

3. **Usage**:
   ```bash
   # Review specific files
   python claude_review.py src/main.py src/utils.py
   
   # Review git changes
   python claude_review.py
   ```

## Best Practices

- **API Key Security**: Use `.env` files and never commit API keys
- **File Size**: Be mindful of large files as they consume API tokens
- **Git State**: Ensure Git repository is in a clean state for diff reviews
- **Output Review**: Always review Claude's suggestions before implementing changes

## Limitations

- **Language Assumption**: Code formatting assumes Python syntax
- **Token Limits**: Large codebases may exceed API token limits
- **Git Dependency**: Git diff mode requires a Git repository
- **API Dependency**: Requires active internet connection and valid API key