<!-- Auto-generated by Claude on 2025-06-22 08:25 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It operates in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes in Git diffs automatically
- **Documentation Output**: Generate structured Markdown reports for easy sharing and archiving
- **Development Workflow**: Streamline code review processes with AI assistance

## Requirements

- Python 3.x
- `anthropic` Python package
- `python-dotenv` package
- Git (for diff mode)
- Anthropic API key

## Environment Setup

The script requires the following environment variables:

```bash
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

Create a `.env` file in your project root with these variables.

## Usage Modes

### Mode 1: File Review
```bash
python claude_review.py file1.py file2.py file3.py
```
Reviews specified files directly.

### Mode 2: Git Diff Review
```bash
python claude_review.py
```
Reviews Git changes (no arguments provided).

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warnings
- Formats code in proper Markdown code blocks
- Assumes Python syntax highlighting

### `get_git_diff()`

Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. Tries `git diff origin/main...HEAD` first
2. Falls back to `git diff HEAD^` if origin/main doesn't exist
3. Returns empty string if both fail

### `main()`

Main execution function that orchestrates the entire review process.

**Key Steps:**
1. Environment setup and API client initialization
2. Mode detection (file review vs. git diff)
3. Content preparation and prompt generation
4. Claude API interaction
5. Output generation

## Output

The tool generates a Markdown file at `docs/claude_review.md` with:

- **Header**: "üß† Claude Review" title
- **Timestamp**: Last updated information
- **Structured Feedback**: Claude's analysis including:
  - Bug identification
  - Logic issues
  - Code clarity suggestions
  - Style consistency recommendations
  - Improvement suggestions

## Error Handling

- **Missing Files**: Warns about missing files but continues processing
- **Git Errors**: Gracefully handles missing Git repositories or branches
- **API Errors**: Catches and reports Claude API failures
- **No Diff Available**: Creates a stub review file when no changes are detected

## Configuration

### Model Selection
The default model is `claude-sonnet-4-20250514`, but can be overridden via the `ANTHROPIC_MODEL` environment variable.

### Token Limit
The script uses a maximum of 1500 tokens for Claude responses. Adjust this in the code if longer reviews are needed.

## Suggestions and Notes

### üîß Improvements
- **Language Detection**: Currently assumes Python syntax highlighting - consider auto-detecting file types
- **Configurable Output**: Make output directory and filename configurable via command line arguments
- **Token Limit**: Consider making max_tokens configurable for different review depths
- **Error Recovery**: Add retry logic for API failures

### ‚ö†Ô∏è Considerations
- **API Costs**: Be mindful of token usage and API costs for large files or frequent reviews
- **File Size Limits**: Large files may exceed Claude's context window
- **Git Dependencies**: Ensure Git is properly configured for diff mode to work

### üí° Usage Tips
- Use in CI/CD pipelines for automated code review
- Combine with pre-commit hooks for continuous feedback
- Review the generated Markdown files in pull requests
- Customize the prompt for specific coding standards or requirements

### üîí Security
- Store API keys securely using environment variables
- Avoid committing `.env` files to version control
- Be cautious when reviewing sensitive code that shouldn't be sent to external APIs