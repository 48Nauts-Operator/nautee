<!-- Auto-generated by Claude on 2025-06-22 11:16 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes in Git diffs automatically
- **Documentation Generation**: Outputs structured Markdown reports for easy sharing and archiving
- **Development Workflow Integration**: Can be integrated into CI/CD pipelines or used as a pre-commit tool

## Requirements

- Python 3.x
- Required packages:
  - `anthropic` - Claude AI API client
  - `python-dotenv` - Environment variable management
- Environment variables:
  - `ANTHROPIC_API_KEY` (required) - Your Anthropic API key
  - `ANTHROPIC_MODEL` (optional) - Defaults to `claude-sonnet-4-20250514`

## Usage

### Mode 1: File Review
Review specific source files:
```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review
Review Git changes (no arguments):
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warning messages
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting (may need adjustment for other languages)

### `get_git_diff()`
Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Behavior:**
- First attempts: `git diff origin/main...HEAD`
- Fallback: `git diff HEAD^` if origin/main doesn't exist
- Returns empty string if both methods fail

### `main()`
Primary orchestration function that handles:
- Environment setup and API client initialization
- Mode detection (file review vs. git diff)
- Claude API interaction
- Output file generation

## Output

The tool generates a Markdown file at `docs/claude_review.md` containing:
- Timestamp of the review
- Structured feedback from Claude
- Analysis focusing on:
  - Bugs or logic issues
  - Code clarity and readability
  - Suggested improvements
  - Style consistency

## Configuration

### Environment Variables

Create a `.env` file in your project root:
```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional
```

### Output Directory

The script automatically creates a `docs/` directory if it doesn't exist.

## Error Handling

- **Missing Files**: Warns about missing files but continues processing others
- **Git Errors**: Gracefully handles cases where Git diff isn't available
- **API Errors**: Exits with error code 1 if Claude API calls fail
- **Missing API Key**: Will fail if `ANTHROPIC_API_KEY` is not set

## Suggestions for Improvement

### Current Limitations
- **Language Assumption**: Hard-coded Python syntax highlighting in `load_code()`
- **Token Limit**: Fixed at 1500 tokens, may be insufficient for large diffs
- **Single Model**: No easy way to switch models without environment variables

### Recommended Enhancements

1. **Multi-language Support**:
   ```python
   def detect_language(file_path):
       extension = os.path.splitext(file_path)[1]
       language_map = {'.py': 'python', '.js': 'javascript', '.java': 'java'}
       return language_map.get(extension, 'text')
   ```

2. **Configurable Token Limits**:
   ```python
   max_tokens = int(os.getenv("CLAUDE_MAX_TOKENS", "1500"))
   ```

3. **Command Line Arguments**:
   ```python
   import argparse
   parser = argparse.ArgumentParser(description='Claude Review Tool')
   parser.add_argument('--output', default='docs/claude_review.md')
   parser.add_argument('--model', default=os.getenv("ANTHROPIC_MODEL"))
   ```

4. **Review Templates**: Allow custom review focus areas through configuration files

5. **Integration Options**: Add support for GitHub Actions, GitLab CI, or other CI/CD platforms

## Example Workflow Integration

### Pre-commit Hook
```bash
#!/bin/bash
python claude_review.py
git add docs/claude_review.md
```

### GitHub Actions
```yaml
- name: Run Claude Review
  run: |
    python claude_review.py
    git add docs/claude_review.md
    git commit -m "Update Claude review" || exit 0
```