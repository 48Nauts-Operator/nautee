<!-- Auto-generated by Claude on 2025-06-01 19:15 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI model to perform automated code reviews. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Provides AI-powered code analysis and feedback
- **Dual Mode Operation**: Supports both file-based and Git diff-based reviews
- **Development Integration**: Generates Markdown output suitable for documentation or CI/CD pipelines
- **Quality Assurance**: Identifies bugs, style issues, and improvement opportunities

## Requirements

### Dependencies
- `anthropic` - Claude API client
- `python-dotenv` - Environment variable management
- `subprocess` - Git command execution
- Standard library modules: `os`, `sys`, `datetime`

### Environment Variables
- `ANTHROPIC_API_KEY` - Required API key for Claude access
- `ANTHROPIC_MODEL` - Optional model specification (defaults to `claude-sonnet-4-20250514`)

## Usage

### Mode 1: File Review
```bash
python claude_review.py file1.py file2.py [additional_files...]
```

### Mode 2: Git Diff Review  
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warning messages
- Formats code with proper syntax highlighting blocks
- Assumes Python syntax highlighting (hardcoded)

### `get_git_diff()`
Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. Attempts `git diff origin/main...HEAD`
2. Falls back to `git diff HEAD^` if origin/main doesn't exist
3. Returns empty string if both fail

### `main()`
Primary execution function that orchestrates the review process.

**Process Flow:**
1. **Setup**: Loads environment variables and initializes Claude client
2. **Mode Detection**: Determines review mode based on command-line arguments
3. **Content Preparation**: Loads files or retrieves Git diff
4. **API Request**: Sends formatted prompt to Claude
5. **Output Generation**: Saves Markdown review to `docs/claude_review.md`

## Output Format

The tool generates a Markdown file at `docs/claude_review.md` with:
- Timestamp header
- Structured feedback from Claude
- Focus areas include:
  - Bug identification
  - Logic issues
  - Code clarity suggestions
  - Style consistency recommendations

## Notes and Suggestions

### ‚ö†Ô∏è Current Limitations

1. **Hardcoded Language Assumption**: The `load_code()` function assumes Python syntax highlighting
   ```python
   # Consider making language detection dynamic
   combined_code += f"\n\n### `{file_path}`\n```python\n{content}\n```"
   ```

2. **Fixed Output Location**: Always writes to `docs/claude_review.md`
   - Consider adding command-line option for custom output paths

3. **Token Limit**: Fixed at 1500 tokens maximum
   - May truncate reviews for large codebases
   - Consider making this configurable

### üîß Recommended Improvements

1. **Add Language Detection**:
   ```python
   def detect_language(file_path):
       extension_map = {'.py': 'python', '.js': 'javascript', '.java': 'java'}
       return extension_map.get(os.path.splitext(file_path)[1], 'text')
   ```

2. **Error Handling Enhancement**:
   - Add retry logic for API failures
   - Implement better file access error handling

3. **Configuration Options**:
   - Make output directory configurable
   - Allow custom token limits
   - Support different Claude models

4. **Git Integration**:
   - Add support for specific commit ranges
   - Include branch comparison options

### üí° Usage Tips

- Ensure `.env` file contains valid `ANTHROPIC_API_KEY`
- Run from Git repository root for diff mode
- Check `docs/` directory permissions for output writing
- Consider rate limiting for large file sets

## Example Output Structure

```markdown
# üß† Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
[Claude's overall assessment]

## Issues Found
- [Specific bugs or problems]

## Suggestions
- [Improvement recommendations]

## Code Quality
- [Style and clarity feedback]
```