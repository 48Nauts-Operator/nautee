<!-- Auto-generated by Claude on 2025-06-22 06:28 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It supports two modes of operation:

1. **Manual File Review**: Review specific source files provided as command-line arguments
2. **Git Diff Review**: Automatically review changes in a Git repository using diff output

The tool outputs structured feedback as a Markdown file, making it easy to integrate into development workflows and documentation systems.

## Features

- ü§ñ AI-powered code review using Claude
- üìÅ Review specific files or Git diffs automatically  
- üìù Structured Markdown output
- üîß Configurable Claude model selection
- üì¶ Git integration with fallback strategies
- ‚ö†Ô∏è Robust error handling for missing files and Git issues

## Prerequisites

- Python 3.6+
- Required packages: `anthropic`, `python-dotenv`
- Anthropic API key
- Git (for diff review mode)

## Installation

1. Install required dependencies:
   ```bash
   pip install anthropic python-dotenv
   ```

2. Set up environment variables in a `.env` file:
   ```
   ANTHROPIC_API_KEY=your_api_key_here
   ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
   ```

## Usage

### Manual File Review
```bash
python claude_review.py file1.py file2.py file3.py
```

### Git Diff Review
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string for review.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with appropriate Markdown syntax highlighting
- Assumes Python syntax highlighting (may need adjustment for other languages)

### `get_git_diff()`
Retrieves Git diff output with intelligent fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. First attempts: `git diff origin/main...HEAD`
2. If failed, tries: `git diff HEAD^`
3. Returns empty string if both fail

### `main()`
Main execution function that orchestrates the entire review process.

**Key Responsibilities:**
- Environment setup and API client initialization
- Mode detection (file review vs. git diff)
- Prompt construction for Claude API
- API communication and response handling
- Output file generation

## Output

The tool generates a Markdown file at `docs/claude_review.md` with:

- **Header**: "üß† Claude Review" 
- **Timestamp**: Last updated information
- **Structured Feedback**: Claude's analysis focusing on:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements  
  - Style consistency

## Configuration

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `ANTHROPIC_API_KEY` | Your Anthropic API key | **Required** |
| `ANTHROPIC_MODEL` | Claude model to use | `claude-sonnet-4-20250514` |

### Output Configuration

- **Output Directory**: `docs/` (created automatically)
- **Output File**: `claude_review.md`
- **Max Tokens**: 1500 (configurable in code)

## Error Handling

The tool includes comprehensive error handling for common scenarios:

- **Missing Files**: Warns and skips non-existent files
- **Git Issues**: Graceful fallback when Git operations fail
- **API Errors**: Clear error messages for Claude API issues
- **No Diff Available**: Creates stub review file when no changes detected

## Notes and Suggestions

### ‚ö†Ô∏è Important Considerations

- **API Costs**: Each review consumes Claude API tokens - monitor usage
- **File Size Limits**: Large files may exceed token limits
- **Language Support**: Currently optimized for Python (syntax highlighting)

### üîß Potential Improvements

1. **Language Detection**: Add automatic language detection for proper syntax highlighting
2. **Configuration File**: Support for `.claude-review.yaml` configuration
3. **Multiple Output Formats**: Support JSON, HTML, or plain text output
4. **Incremental Reviews**: Cache and compare previous reviews
5. **Custom Prompts**: Allow user-defined review criteria and prompts
6. **Batch Processing**: Support for reviewing entire directory trees

### üí° Usage Tips

- Use descriptive commit messages for better diff context
- Review smaller changesets for more focused feedback
- Consider splitting large files before review
- Integrate into CI/CD pipelines for automated code review

## Integration Examples

### Pre-commit Hook
```bash
#!/bin/sh
python claude_review.py
git add docs/claude_review.md
```

### GitHub Actions
```yaml
- name: Run Claude Review
  run: python claude_review.py
- name: Commit Review
  run: |
    git add docs/claude_review.md
    git commit -m "Update Claude review" || exit 0
```