<!-- Auto-generated by Claude on 2025-06-23 03:26 -->

# Claude Review Tool Documentation

## Overview

The **Claude Review Tool** is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can operate in two distinct modes:

1. **Manual File Review**: Reviews specific source files provided as command-line arguments
2. **Git Diff Review**: Reviews changes in a Git repository by analyzing diffs

The tool outputs structured feedback in Markdown format, making it easy to integrate into development workflows and documentation systems.

## Purpose

This tool is designed to:
- Automate code review processes using AI
- Provide consistent, structured feedback on code quality
- Support both targeted file reviews and Git-based change reviews
- Generate readable Markdown documentation of review results

## Dependencies

```python
import os
import sys
import anthropic
from dotenv import load_dotenv
from datetime import datetime
import subprocess
```

### Required Packages
- `anthropic` - Claude AI API client
- `python-dotenv` - Environment variable management

## Configuration

The tool requires the following environment variables:

- `ANTHROPIC_API_KEY` - Your Anthropic API key (required)
- `ANTHROPIC_MODEL` - Claude model to use (optional, defaults to `claude-sonnet-4-20250514`)

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string for review.

**Parameters:**
- `file_paths` (list): List of file paths to load

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warnings
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting (hardcoded)

### `get_git_diff()`

Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Fallback Strategy:**
1. First attempts: `git diff origin/main...HEAD`
2. If failed, tries: `git diff HEAD^`
3. Returns empty string if both fail

## Usage

### Manual File Review Mode

```bash
python claude_review.py file1.py file2.py file3.py
```

Reviews the specified files and provides feedback on:
- Bugs or logic issues
- Code clarity
- Suggested improvements  
- Style consistency

### Git Diff Review Mode

```bash
python claude_review.py
```

When no files are specified, automatically reviews Git changes using diff analysis.

## Output

- **Location**: `docs/claude_review.md`
- **Format**: Markdown with timestamp and structured feedback
- **Auto-creation**: Creates `docs/` directory if it doesn't exist

## Error Handling

The tool includes robust error handling for:
- Missing files (warns and skips)
- Git command failures (graceful fallbacks)
- Claude API errors (exits with error code 1)
- Missing Git diffs (creates stub review file)

## Suggestions and Notes

### Improvements Needed

1. **Language Detection**: The `load_code()` function hardcodes Python syntax highlighting. Consider detecting file extensions:
   ```python
   def get_language(file_path):
       ext = os.path.splitext(file_path)[1]
       return {'py': 'python', '.js': 'javascript', '.go': 'go'}.get(ext, '')
   ```

2. **Configuration File**: Consider adding a config file for:
   - Custom review prompts
   - File type mappings
   - Output format preferences

3. **Token Limit**: The current token limit (1500) might be insufficient for large reviews. Consider making this configurable.

### Security Considerations

- Store API keys securely using `.env` files
- Add `.env` to `.gitignore`
- Consider implementing API key validation

### Integration Tips

- Use as a pre-commit hook for automated reviews
- Integrate with CI/CD pipelines
- Set up as a Git alias for easy access:
  ```bash
  git config alias.claude-review '!python /path/to/claude_review.py'
  ```

### Example Environment Setup

```bash
# .env file
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514
```

This tool provides a solid foundation for AI-powered code reviews and can be extended based on specific team requirements and workflows.