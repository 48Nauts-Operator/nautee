<!-- Auto-generated by Claude on 2025-06-01 10:20 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that provides automated code review functionality using Anthropic's Claude AI. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Leverage Claude AI to identify bugs, logic issues, and improvement opportunities
- **Git Integration**: Review changes between commits or branches automatically
- **Documentation Generation**: Output structured feedback in Markdown format for easy sharing and integration
- **Development Workflow Enhancement**: Streamline the code review process with AI assistance

## Installation & Setup

### Prerequisites

- Python 3.x
- Anthropic API key
- Git (for diff mode)

### Environment Variables

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_anthropic_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

### Dependencies

```bash
pip install anthropic python-dotenv
```

## Usage

### Mode 1: File Review

Review specific source files:

```bash
python claude_review.py file1.py file2.py [additional_files...]
```

### Mode 2: Git Diff Review

Review Git changes (no arguments):

```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with appropriate syntax highlighting
- Assumes Python syntax highlighting (may need adjustment for other languages)

### `get_git_diff()`

Retrieves Git diff output with fallback strategies.

**Returns:**
- `str`: Git diff output or empty string if unavailable

**Fallback Strategy:**
1. First attempts: `git diff origin/main...HEAD`
2. If failed, tries: `git diff HEAD^`
3. Returns empty string if both fail

### `main()`

Main execution function that orchestrates the review process.

**Process Flow:**
1. Loads environment variables and initializes Claude client
2. Creates output directory (`docs/`)
3. Determines operation mode based on command-line arguments
4. Generates appropriate prompt for Claude
5. Calls Claude API and saves formatted output

## Output

The tool generates a Markdown file at `docs/claude_review.md` with:

- **Header**: "ðŸ§  Claude Review" with timestamp
- **Structured Feedback**: Claude's analysis focusing on:
  - Bugs or logic issues
  - Code clarity
  - Suggested improvements  
  - Style consistency

## Configuration Options

### Model Selection

Set the Claude model via environment variable:
- Default: `claude-sonnet-4-20250514`
- Override with `ANTHROPIC_MODEL` environment variable

### API Parameters

- **Max Tokens**: 1500 (hardcoded)
- **Model**: Configurable via environment variable
- **Message Role**: User prompt format

## Error Handling

- **Missing Files**: Warns and continues processing remaining files
- **Git Errors**: Graceful fallback between different Git diff strategies  
- **API Errors**: Clear error messages with non-zero exit codes
- **No Diff Available**: Creates stub review file when no changes detected

## Notes & Suggestions

### Improvements

1. **Language Detection**: Currently assumes Python syntax highlighting
   ```python
   # Consider detecting file extensions and using appropriate syntax
   file_extension = os.path.splitext(file_path)[1]
   syntax = get_syntax_from_extension(file_extension)
   ```

2. **Configurable Output**: Make output directory and filename configurable
   ```python
   output_dir = os.getenv("REVIEW_OUTPUT_DIR", "docs")
   output_file = os.getenv("REVIEW_OUTPUT_FILE", "claude_review.md")
   ```

3. **Token Limit Management**: Implement content truncation for large diffs
4. **Multiple Model Support**: Allow switching between different Claude models based on content size

### Best Practices

- **API Key Security**: Never commit `.env` files to version control
- **Rate Limiting**: Be mindful of API usage limits
- **File Size**: Large files may exceed token limits - consider chunking
- **Git Repository**: Ensure you're in a valid Git repository for diff mode

### Integration Ideas

- **CI/CD Integration**: Run as part of pull request workflows
- **Pre-commit Hooks**: Integrate with Git hooks for automatic review
- **IDE Integration**: Create plugins for popular development environments
- **Slack/Teams**: Post reviews to team communication channels

## Example Output Structure

```markdown
# ðŸ§  Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
[Claude's overall assessment]

## Issues Found
- [Specific bugs or problems]

## Suggestions
- [Improvement recommendations]

## Code Quality Notes
- [Style and clarity feedback]
```