<!-- Auto-generated by Claude on 2025-06-08 01:51 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes in Git diffs automatically
- **Documentation**: Generate structured Markdown reports for code reviews
- **Development Workflow**: Integrate AI reviews into CI/CD pipelines or development processes

## Requirements

- Python 3.x
- Anthropic API key
- Required packages: `anthropic`, `python-dotenv`
- Git (for diff mode)

## Setup

1. Install required dependencies:
   ```bash
   pip install anthropic python-dotenv
   ```

2. Create a `.env` file with your API credentials:
   ```env
   ANTHROPIC_API_KEY=your_api_key_here
   ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
   ```

## Usage Modes

### Mode 1: File Review
Review specific source files by passing them as command-line arguments:
```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review
Review Git changes by running without arguments:
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`
- **Purpose**: Combines multiple source files into a single Markdown-formatted string
- **Parameters**: 
  - `file_paths` (list): List of file paths to process
- **Returns**: Markdown-formatted string containing all file contents
- **Features**:
  - Handles missing files gracefully with warnings
  - Formats code with proper syntax highlighting
  - Preserves file structure and naming

### `get_git_diff()`
- **Purpose**: Retrieves Git diff output with fallback strategies
- **Returns**: Git diff string or empty string if unavailable
- **Strategy**:
  1. First attempts `git diff origin/main...HEAD`
  2. Falls back to `git diff HEAD^` if origin/main doesn't exist
  3. Returns empty string if both fail

### `main()`
- **Purpose**: Main execution function that orchestrates the review process
- **Workflow**:
  1. Sets up environment and API client
  2. Determines review mode based on command-line arguments
  3. Generates appropriate prompts for Claude
  4. Makes API calls and handles responses
  5. Saves formatted output to `docs/claude_review.md`

## Output Format

The tool generates a Markdown file (`docs/claude_review.md`) with:
- **Header**: "ðŸ§  Claude Review" with timestamp
- **Structured Feedback**: Claude's analysis including:
  - Bug identification
  - Code clarity assessment
  - Improvement suggestions
  - Style consistency notes

## Configuration

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `ANTHROPIC_API_KEY` | Your Anthropic API key | **Required** |
| `ANTHROPIC_MODEL` | Claude model to use | `claude-sonnet-4-20250514` |

### Model Settings
- **Max Tokens**: 1500 (configured for concise but comprehensive reviews)
- **Output Directory**: `docs/` (created automatically)

## Error Handling

- **Missing Files**: Warns and skips non-existent files
- **Git Errors**: Graceful fallback between diff strategies
- **API Errors**: Catches and reports Claude API issues
- **No Diff Available**: Creates stub review file when no changes found

## Best Practices

### For File Reviews
- Review related files together for context
- Focus on files with recent changes
- Consider reviewing test files alongside implementation

### For Git Diff Reviews
- Use in pre-commit hooks or CI/CD pipelines
- Review before merging pull requests
- Combine with human code review processes

## Limitations and Considerations

- **Token Limit**: Reviews are capped at 1500 tokens; very large diffs may be truncated
- **API Costs**: Each review consumes Anthropic API credits
- **Language Support**: Optimized for Python but works with other languages
- **Context**: Limited to provided files/diffs without broader codebase context

## Integration Suggestions

### CI/CD Pipeline
```yaml
# Example GitHub Actions step
- name: AI Code Review
  run: |
    python claude_review.py
    # Upload or comment the review results
```

### Pre-commit Hook
```bash
#!/bin/sh
python /path/to/claude_review.py
```

### Development Workflow
- Run before committing changes
- Use for architectural decision documentation
- Integrate with code review tools

## Notes

- The tool assumes Python syntax highlighting but can review any text-based files
- Reviews are saved with timestamps for tracking changes over time
- The `docs/` directory structure makes it easy to version control reviews
- Consider rate limiting when using in automated environments