<!-- Auto-generated by Claude on 2025-06-23 01:50 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages the Claude AI API to perform automated code reviews. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes in pull requests or commits automatically  
- **Documentation Generation**: Output structured reviews in Markdown format for easy sharing
- **Development Workflow**: Streamline code review processes with consistent AI analysis

## Requirements

- Python 3.x
- `anthropic` library for Claude API access
- `python-dotenv` for environment variable management
- Git (for diff mode)
- Anthropic API key

## Configuration

Create a `.env` file in your project root:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage Modes

### Mode 1: File Review
Review specific source files by passing them as command-line arguments:

```bash
python claude_review.py file1.py file2.py module/file3.py
```

### Mode 2: Git Diff Review  
Run without arguments to review Git changes:

```bash
python claude_review.py
```

The tool will attempt to get diffs in this order:
1. `git diff origin/main...HEAD` 
2. `git diff HEAD^` (fallback)

## Key Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting

### `get_git_diff()`

Retrieves Git diff output with intelligent fallback logic.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Behavior:**
- First tries `git diff origin/main...HEAD` for PR-style diffs
- Falls back to `git diff HEAD^` for recent changes
- Returns empty string if Git operations fail

### `main()`

Main execution function that orchestrates the review process.

**Key Steps:**
1. Environment setup and API client initialization
2. Mode determination (file review vs. Git diff)
3. Prompt construction based on selected mode
4. Claude API interaction
5. Markdown output generation

## Output

Reviews are saved to `docs/claude_review.md` with:

- **Header**: "üß† Claude Review" with timestamp
- **Structured Feedback**: AI-generated analysis focusing on:
  - Bugs or logic issues
  - Code clarity and readability
  - Suggested improvements
  - Style consistency

## Error Handling

- **Missing Files**: Skipped with warning messages
- **Git Errors**: Graceful fallback between diff strategies
- **API Errors**: Clear error messages with non-zero exit codes
- **No Changes**: Creates stub review when no diff is available

## Notes and Suggestions

### ‚ö†Ô∏è Important Considerations

- **API Costs**: Each review consumes Claude API tokens (max 1500 per request)
- **File Size Limits**: Large files may exceed API context limits
- **Security**: Ensure `.env` file is in `.gitignore` to protect API keys

### üîß Potential Improvements

1. **Language Detection**: Currently assumes Python syntax highlighting
   ```python
   # Consider detecting file extensions for proper syntax highlighting
   extension = os.path.splitext(file_path)[1]
   language = {'py': 'python', 'js': 'javascript'}.get(extension[1:], '')
   ```

2. **Configuration File**: Add support for review focus areas and custom prompts

3. **Batch Processing**: Handle large diffs by splitting into chunks

4. **Integration Hooks**: Add support for pre-commit hooks or CI/CD integration

### üí° Usage Tips

- Run regularly during development for consistent feedback
- Use file mode for focused reviews of specific modules
- Use Git mode for PR reviews and change analysis
- Combine with existing code review processes rather than replacing them

## Example Output Structure

```markdown
# üß† Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
Brief overview of the review findings...

## Issues Found
- **Bug**: Potential null pointer exception in line 42
- **Style**: Inconsistent naming conventions

## Suggestions  
- Consider adding error handling for edge cases
- Refactor long functions for better readability
```