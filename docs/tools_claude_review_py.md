<!-- Auto-generated by Claude on 2025-06-23 07:21 -->

# Claude Review Tool

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI model to perform automated code reviews. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

- **Automated Code Review**: Get AI-powered feedback on code quality, bugs, and improvements
- **Git Integration**: Review changes in Git diffs automatically
- **Documentation**: Generate structured Markdown reports for easy sharing and archiving
- **Development Workflow**: Streamline code review processes in CI/CD pipelines

## Features

- **Dual Operation Modes**: File-based review or Git diff analysis
- **Markdown Output**: Clean, structured feedback in Markdown format
- **Git Integration**: Automatic diff detection with fallback strategies
- **Error Handling**: Graceful handling of missing files and Git errors
- **Configurable**: Uses environment variables for API keys and model selection

## Requirements

### Dependencies
```python
anthropic  # Claude AI API client
python-dotenv  # Environment variable management
```

### Environment Variables
```bash
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
```

## Functions

### `load_code(file_paths)`

Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to load

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting (hardcoded)

### `get_git_diff()`

Retrieves Git diff output with intelligent fallback strategy.

**Returns:**
- `str`: Git diff output or empty string if unavailable

**Fallback Strategy:**
1. First attempts `git diff origin/main...HEAD`
2. Falls back to `git diff HEAD^` if origin/main doesn't exist
3. Returns empty string if both fail

## Usage

### Mode 1: File Review
```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review
```bash
python claude_review.py
```

## Output

The tool generates a Markdown file at `docs/claude_review.md` with:
- Timestamp header
- Structured feedback from Claude
- Focus areas: bugs, code clarity, improvements, style consistency

## Code Structure

### Main Workflow

1. **Setup Phase**
   - Load environment variables
   - Initialize Anthropic client
   - Create output directory
   - Parse command line arguments

2. **Mode Selection**
   - **File Mode**: Load and combine specified files
   - **Diff Mode**: Extract Git diff with fallbacks

3. **AI Review**
   - Send formatted prompt to Claude
   - Process response
   - Save structured Markdown output

## Notes and Suggestions

### ‚ö†Ô∏è Current Limitations

- **Language Detection**: Code formatting is hardcoded to Python syntax
- **File Size**: No validation for large files that might exceed token limits
- **Error Recovery**: Limited error handling for malformed files

### üîß Suggested Improvements

1. **Dynamic Language Detection**
   ```python
   def detect_language(file_path):
       extension_map = {
           '.py': 'python',
           '.js': 'javascript', 
           '.java': 'java',
           # Add more mappings
       }
       return extension_map.get(os.path.splitext(file_path)[1], 'text')
   ```

2. **Token Limit Validation**
   - Add token counting before API calls
   - Implement file chunking for large codebases

3. **Configuration File Support**
   - Add YAML/JSON config for review criteria
   - Customizable prompt templates

4. **Enhanced Git Integration**
   ```python
   # Add support for specific branches
   git diff feature-branch...main
   # Add commit range support
   git diff abc123..def456
   ```

### üí° Best Practices

- **Environment Setup**: Always use `.env` files for API keys
- **Output Management**: Consider timestamped output files for history tracking
- **Error Handling**: Monitor API rate limits and quota usage
- **Integration**: Perfect for pre-commit hooks or CI/CD pipelines

### üöÄ Usage Tips

- Run regularly on feature branches before merging
- Use file mode for focused reviews of specific modules
- Combine with existing code review processes, don't replace human review
- Archive review outputs for team learning and process improvement