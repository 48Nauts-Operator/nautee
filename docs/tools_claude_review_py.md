<!-- Auto-generated by Claude on 2025-06-08 05:20 -->

# Claude Review Tool

A Python script that leverages Anthropic's Claude AI to perform automated code reviews on either specified source files or Git diffs. The tool generates structured feedback in Markdown format for easy reading and documentation.

## Purpose

This tool automates the code review process by:
- Analyzing individual source files or Git diffs
- Providing structured feedback on code quality, bugs, and improvements
- Generating professional Markdown documentation with timestamps
- Supporting flexible review workflows for development teams

## Features

- **Dual Operation Modes**: Review specific files or Git diffs automatically
- **AI-Powered Analysis**: Uses Claude AI for comprehensive code review
- **Markdown Output**: Generates clean, formatted documentation
- **Git Integration**: Automatically detects and reviews changes between branches
- **Error Handling**: Gracefully handles missing files and Git errors

## Installation Requirements

- Python 3.x
- Required packages:
  ```bash
  pip install anthropic python-dotenv
  ```
- Environment variables in `.env` file:
  ```
  ANTHROPIC_API_KEY=your_api_key_here
  ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
  ```

## Usage

### Mode 1: Review Specific Files
```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Review Git Diff
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`
- **Purpose**: Combines multiple source files into a single Markdown-formatted string
- **Parameters**: `file_paths` (list) - List of file paths to process
- **Returns**: Formatted string with code blocks for each file
- **Features**: 
  - Skips missing files with warnings
  - Formats each file with proper Markdown syntax highlighting

### `get_git_diff()`
- **Purpose**: Retrieves Git diff output with fallback strategies
- **Returns**: Git diff string or empty string if unavailable
- **Logic**:
  1. First attempts `git diff origin/main...HEAD`
  2. Falls back to `git diff HEAD^` if origin/main unavailable
  3. Returns empty string if both fail

### `main()`
- **Purpose**: Main orchestration function handling both review modes
- **Workflow**:
  1. Sets up environment and API client
  2. Determines review mode based on command-line arguments
  3. Prepares appropriate prompts for Claude
  4. Makes API call and processes response
  5. Saves formatted output to `docs/claude_review.md`

## Output

The tool generates a file at `docs/claude_review.md` containing:
- Timestamped header
- Structured feedback from Claude
- Analysis of bugs, code clarity, improvements, and style consistency

## Error Handling

- **Missing Files**: Warns but continues processing remaining files
- **Git Errors**: Gracefully falls back through different Git commands
- **API Errors**: Exits cleanly with error message
- **No Diff Available**: Creates stub review file instead of failing

## Notes and Suggestions

### Security
- **API Key Protection**: Ensure `.env` file is in `.gitignore`
- **Rate Limiting**: Consider adding delays for large batches of files

### Enhancements
- Add support for different programming languages beyond Python
- Implement configuration file for custom review criteria
- Add option to specify custom output file paths
- Consider adding diff size limits to prevent API token overflow

### Best Practices
- Run this tool as part of your CI/CD pipeline
- Review the generated Markdown files before merging PRs
- Use the file-specific mode for focused reviews of critical components
- Use the Git diff mode for comprehensive change reviews

### Limitations
- Maximum token limit of 1500 may truncate large diffs
- Assumes Python syntax highlighting for all files
- Requires active Git repository for diff mode