<!-- Auto-generated by Claude on 2025-06-22 18:24 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can analyze either specific source files or Git diffs, providing structured feedback in a Markdown format.

## Purpose

This tool automates the code review process by:
- Analyzing Python source files for bugs, clarity, and style issues
- Reviewing Git diffs to provide feedback on code changes
- Generating structured, readable reports in Markdown format
- Integrating with development workflows for continuous code quality assessment

## Features

- **Dual Operation Modes**: Can review specific files or Git diffs
- **Intelligent Git Diff Detection**: Automatically tries multiple Git diff strategies
- **Markdown Output**: Generates clean, structured reports
- **Error Handling**: Gracefully handles missing files and API errors
- **Configurable Models**: Supports different Claude model versions

## Installation Requirements

```bash
pip install anthropic python-dotenv
```

## Environment Setup

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Usage

### Mode 1: File-Specific Review
```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review
```bash
python claude_review.py
```

## Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Handles missing files gracefully with warning messages
- Formats code with proper syntax highlighting
- Creates clear file separation with headers

### `get_git_diff()`
Retrieves Git diff output using a fallback strategy.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Strategy:**
1. First attempts: `git diff origin/main...HEAD`
2. Fallback: `git diff HEAD^`
3. Returns empty string if both fail

### `main()`
The primary execution function that orchestrates the entire review process.

**Workflow:**
1. **Setup Phase**: Loads environment variables and initializes Claude client
2. **Mode Detection**: Determines whether to review files or Git diff
3. **Content Processing**: Prepares appropriate prompts for Claude
4. **API Interaction**: Sends content to Claude for analysis
5. **Output Generation**: Saves structured feedback to Markdown file

## Output

The tool generates a file at `docs/claude_review.md` containing:
- Timestamp of the review
- Structured feedback focusing on:
  - Bugs or logic issues
  - Code clarity and readability
  - Suggested improvements
  - Style consistency

## Error Handling

- **Missing Files**: Skips non-existent files with warnings
- **Git Errors**: Falls back to alternative diff strategies
- **API Errors**: Displays error messages and exits gracefully
- **Missing API Key**: Will fail with Anthropic client initialization error

## Configuration Notes

### Model Selection
The default model is `claude-sonnet-4-20250514`, but you can override this via the `ANTHROPIC_MODEL` environment variable.

### Output Directory
The script automatically creates a `docs/` directory if it doesn't exist.

### Token Limits
Currently set to 1500 max tokens. Adjust based on your needs and API limits.

## Best Practices

### For File Reviews
- Review related files together for better context
- Keep file count reasonable to stay within token limits
- Ensure files are properly formatted before review

### For Git Diff Reviews
- Use meaningful commit messages for better context
- Keep diffs focused and manageable in size
- Run reviews on feature branches before merging

## Troubleshooting

### Common Issues

1. **API Key Not Found**
   ```
   Solution: Ensure ANTHROPIC_API_KEY is set in your .env file
   ```

2. **No Git Diff Available**
   ```
   Solution: Ensure you're in a Git repository with commits
   ```

3. **File Not Found Warnings**
   ```
   Solution: Check file paths and ensure files exist
   ```

## Integration Suggestions

- **CI/CD Integration**: Add to pre-commit hooks or GitHub Actions
- **IDE Integration**: Create shortcuts or extensions for quick reviews
- **Team Workflows**: Standardize review processes across development teams

## Limitations

- Requires internet connection for Claude API
- Limited by Claude's token constraints
- Python-focused but can be adapted for other languages
- Requires Anthropic API credits