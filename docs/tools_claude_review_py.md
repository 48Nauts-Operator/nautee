<!-- Auto-generated by Claude on 2025-06-23 08:29 -->

# Claude Review Tool Documentation

## Overview

The Claude Review Tool is a Python script that leverages Anthropic's Claude AI to perform automated code reviews. It can operate in two modes: reviewing specific source files or analyzing Git diffs. The tool generates structured feedback in Markdown format, making it easy to integrate into development workflows.

## Purpose

This tool helps developers get AI-powered code reviews by:
- Analyzing individual source files for bugs, clarity, and improvements
- Reviewing Git diffs to catch issues in code changes
- Generating structured, readable feedback in Markdown format
- Integrating with existing development workflows

## Prerequisites

- Python 3.x
- Anthropic API key
- Required Python packages: `anthropic`, `python-dotenv`
- Git (for diff mode)

## Setup

1. Install required dependencies:
   ```bash
   pip install anthropic python-dotenv
   ```

2. Create a `.env` file with your configuration:
   ```env
   ANTHROPIC_API_KEY=your_api_key_here
   ANTHROPIC_MODEL=claude-sonnet-4-20250514
   ```

## Usage

### Mode 1: File Review
Review specific source files:
```bash
python claude_review.py file1.py file2.py file3.py
```

### Mode 2: Git Diff Review
Review Git changes (no arguments):
```bash
python claude_review.py
```

## Key Functions

### `load_code(file_paths)`
Combines multiple source files into a single Markdown-formatted string.

**Parameters:**
- `file_paths` (list): List of file paths to process

**Returns:**
- `str`: Markdown-formatted string containing all file contents

**Features:**
- Skips missing files with warning messages
- Formats each file with proper Markdown code blocks
- Assumes Python syntax highlighting

### `get_git_diff()`
Retrieves Git diff output with fallback options.

**Returns:**
- `str`: Git diff content or empty string if unavailable

**Behavior:**
- First attempts `git diff origin/main...HEAD`
- Falls back to `git diff HEAD^` if origin/main doesn't exist
- Returns empty string if both commands fail

### `main()`
Main execution function that coordinates the review process.

**Process:**
1. Loads environment variables and initializes Claude client
2. Determines operation mode based on command-line arguments
3. Prepares appropriate prompt for Claude
4. Makes API call and processes response
5. Saves formatted review to `docs/claude_review.md`

## Output

The tool generates a Markdown file at `docs/claude_review.md` with:
- Timestamp of the review
- Structured feedback from Claude
- Analysis of bugs, code clarity, improvements, and style consistency

## Configuration

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `ANTHROPIC_API_KEY` | Your Anthropic API key | Required |
| `ANTHROPIC_MODEL` | Claude model to use | `claude-sonnet-4-20250514` |

## Error Handling

- **Missing files**: Warns and skips non-existent files
- **Git errors**: Graceful fallback from `origin/main` to `HEAD^`
- **API errors**: Exits with error code 1 and descriptive message
- **No diff available**: Creates stub review file instead of failing

## Notes and Suggestions

### Strengths
- âœ… Flexible dual-mode operation
- âœ… Good error handling and user feedback
- âœ… Clean Markdown output format
- âœ… Emoji-based status messages for better UX

### Potential Improvements

1. **Language Detection**: Currently assumes Python syntax highlighting
   ```python
   # Consider detecting file extension for proper syntax highlighting
   extension = os.path.splitext(file_path)[1]
   language = get_language_from_extension(extension)
   ```

2. **Configuration File**: Add support for custom review criteria
   ```python
   # Could load custom prompts or review focus areas
   config = load_config('claude_review_config.yaml')
   ```

3. **Token Limit Management**: The 1500 token limit might be restrictive for large diffs
   ```python
   # Consider dynamic token allocation based on input size
   max_tokens = min(4000, len(prompt) * 2)
   ```

4. **Output Customization**: Allow custom output paths and formats
   ```python
   # Add command-line argument for output path
   parser.add_argument('--output', default='docs/claude_review.md')
   ```

### Integration Tips

- Add to Git hooks for automatic pre-commit reviews
- Integrate with CI/CD pipelines for pull request reviews
- Use in IDE workflows for on-demand code analysis
- Consider rate limiting for batch file processing

## Example Output Structure

```markdown
# ðŸ§  Claude Review

_Last updated: 2024-01-15 14:30_

## Summary
Brief overview of the review findings...

## Issues Found
- Bug descriptions and locations
- Logic problems
- Potential improvements

## Suggestions
- Code clarity improvements
- Style consistency recommendations
- Best practice suggestions
```