<!-- Auto-generated by Claude on 2025-06-08 01:51 -->

# Claude Folder Review (Batched) Documentation

## Overview

This Python script provides an automated code review solution that uses Anthropic's Claude AI to analyze source code files in batches. It recursively scans a folder for source code files, intelligently groups them into token-limited batches, and generates comprehensive Markdown reviews for each batch.

## Purpose

- **Automated Code Review**: Leverages Claude AI to provide intelligent code analysis and suggestions
- **Batch Processing**: Handles large codebases by splitting files into manageable chunks
- **Documentation Generation**: Creates structured Markdown reports for easy reading and sharing
- **Quality Assurance**: Identifies code organization issues, bug patterns, and architectural weaknesses

## Key Features

- ✅ Recursive folder scanning
- ✅ Smart token-based batching (~10k tokens per batch)
- ✅ Multiple programming language support
- ✅ Test file exclusion
- ✅ Automatic Markdown report generation
- ✅ Error handling and progress tracking

## Dependencies

```python
import os
import sys
import anthropic
from dotenv import load_dotenv
from datetime import datetime
import time
```

**Required packages:**
- `anthropic` - Claude AI API client
- `python-dotenv` - Environment variable management

## Environment Setup

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_claude_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

## Important Functions

### `is_excluded(filename: str) -> bool`

Determines whether a file should be excluded from review based on naming patterns.

**Excludes:**
- Files containing "test" in the name
- Files starting with "test_"
- Files in test directories

```python
# Examples of excluded files:
# - test_utils.py
# - /tests/test_main.py
# - utils_test.js
```

### `estimate_tokens(text: str) -> int`

Provides a rough token count estimation for batching purposes.

**Formula:** `token_count ≈ character_count / 4`

> **Note:** This is an approximation. Actual token counts may vary depending on the content structure.

## Supported File Types

The script processes files with the following extensions:

- **Python**: `.py`
- **JavaScript/TypeScript**: `.js`, `.ts`, `.tsx`, `.jsx`
- **Web**: `.html`, `.css`
- **Data**: `.json`, `.yaml`, `.yml`
- **Other Languages**: `.go`, `.java`

## Usage

### Basic Usage
```bash
python claude_folder_review.py [folder_path]
```

### Examples
```bash
# Review current directory's parent folder
python claude_folder_review.py ../my-project

# Review specific folder
python claude_folder_review.py /path/to/codebase

# Use default folder (../137docs)
python claude_folder_review.py
```

## Output Structure

Reviews are saved in the `docs/folder_review/` directory:

```
docs/folder_review/
├── folder_review_batch_01.md
├── folder_review_batch_02.md
└── folder_review_batch_03.md
```

Each batch file contains:
- Batch number and timestamp
- Code organization analysis
- Bug pattern identification
- Architecture weakness assessment
- Modularization suggestions

## Review Focus Areas

The Claude AI reviewer focuses on:

- **Code Organization** - Structure and maintainability
- **Bug Patterns** - Common error-prone patterns
- **Architecture Weaknesses** - Design flaws and anti-patterns  
- **Suggestions** - Recommendations for improvement and refactoring

## Configuration

### Token Limit
```python
MAX_TOKENS = 10000  # Adjust based on your needs and API limits
```

### Model Selection
Set via environment variable:
```env
ANTHROPIC_MODEL=claude-sonnet-4-20250514
```

## Error Handling

The script includes robust error handling for:
- File reading errors
- API communication issues
- Missing environment variables
- Empty folder scenarios

## Performance Notes

- **Batch Processing**: Efficiently handles large codebases by splitting into manageable chunks
- **Progress Tracking**: Real-time feedback on processing status
- **Time Tracking**: Reports total processing time upon completion

## Suggestions for Improvement

1. **Add Configuration File**: Consider using a YAML/JSON config file for settings
2. **Custom Exclusion Patterns**: Allow users to define custom file exclusion rules
3. **Output Format Options**: Support for HTML, PDF, or other output formats
4. **Parallel Processing**: Implement concurrent API calls for faster processing
5. **Incremental Updates**: Skip unchanged files in subsequent runs
6. **Integration**: Add CI/CD pipeline integration capabilities

## Troubleshooting

### Common Issues

**No files found:**
- Check folder path exists
- Verify file extensions are supported
- Ensure files aren't being excluded by test filters

**API errors:**
- Verify `ANTHROPIC_API_KEY` is set correctly
- Check API rate limits and quotas
- Ensure model name is valid

**Permission errors:**
- Verify read permissions on source folder
- Ensure write permissions on output directory