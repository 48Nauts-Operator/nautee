<!-- Auto-generated by Claude on 2025-05-31 22:59 -->

# Claude Folder Review (Batched) Documentation

## Overview

This Python script performs automated code review on source code files using Anthropic's Claude AI model. It recursively scans a specified folder, groups files into token-optimized batches, and generates detailed Markdown reviews for each batch.

## Purpose

- **Automated Code Review**: Leverage Claude AI to analyze codebases for architectural issues, bug patterns, and improvement opportunities
- **Batch Processing**: Handle large codebases by splitting files into manageable chunks (~10k tokens each)
- **Documentation Generation**: Output structured Markdown reviews for easy reading and sharing

## Key Features

- Recursive folder scanning with file type filtering
- Intelligent batching based on token estimation
- Exclusion of test files to focus on core application code
- Configurable Claude model selection
- Timestamped output with organized file structure

## Functions

### `is_excluded(filename: str) -> bool`

Determines whether a file should be excluded from review based on naming patterns.

**Parameters:**
- `filename` (str): The file path to check

**Returns:**
- `bool`: True if the file should be excluded (test files), False otherwise

**Exclusion Criteria:**
- Files containing "test" in the name (case-insensitive)
- Files starting with "test_"
- Files in directories containing "test"

### `estimate_tokens(text: str) -> int`

Provides a rough token count estimation for text content.

**Parameters:**
- `text` (str): The source code content

**Returns:**
- `int`: Estimated token count (using 4 characters ‚âà 1 token ratio)

### `main()`

The primary execution function that orchestrates the entire review process:

1. **Setup Phase**: Loads environment variables and initializes Claude client
2. **File Discovery**: Recursively scans for valid source files
3. **Batching**: Groups files into token-optimized batches
4. **Review Generation**: Processes each batch through Claude API
5. **Output**: Saves individual Markdown files for each batch

## Configuration

### Environment Variables

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_claude_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514
```

### Supported File Types

The script processes files with these extensions:
- **Python**: `.py`
- **JavaScript/TypeScript**: `.js`, `.ts`, `.tsx`, `.jsx`
- **Web**: `.html`, `.css`
- **Data**: `.json`, `.yaml`, `.yml`
- **Other Languages**: `.go`, `.java`

## Usage

### Basic Usage

```bash
python claude_folder_review.py /path/to/your/codebase
```

### Default Folder

If no folder is specified, it defaults to `../137docs`:

```bash
python claude_folder_review.py
```

## Output Structure

Reviews are saved to `docs/folder_review/` with the following naming pattern:

```
docs/folder_review/
‚îú‚îÄ‚îÄ folder_review_batch_01.md
‚îú‚îÄ‚îÄ folder_review_batch_02.md
‚îî‚îÄ‚îÄ folder_review_batch_03.md
```

Each file contains:
- Batch number and timestamp
- Detailed code review focusing on:
  - Code organization
  - Bug patterns
  - Architecture weaknesses
  - Modularization suggestions

## Dependencies

```python
pip install anthropic python-dotenv
```

## Notes and Suggestions

### ‚ö†Ô∏è Important Considerations

- **API Costs**: Each batch consumes Claude API tokens - monitor usage for large codebases
- **Rate Limits**: The script doesn't implement rate limiting - consider adding delays for large batches
- **Token Estimation**: The 4:1 character-to-token ratio is approximate and may vary

### üîß Potential Improvements

1. **Add Progress Indicators**: Include file count and estimated completion time
2. **Error Handling**: Implement retry logic for API failures
3. **Configuration File**: Move hardcoded values (file extensions, token limits) to config
4. **Summary Generation**: Create an overview file combining insights from all batches
5. **Rate Limiting**: Add configurable delays between API calls

### üí° Usage Tips

- **Large Codebases**: Consider running on specific subdirectories first
- **Review Quality**: Smaller batches (lower `MAX_TOKENS`) may provide more detailed reviews
- **File Filtering**: Modify `valid_exts` and `is_excluded()` to match your project needs

## Example Output Format

Each generated review file follows this structure:

```markdown
# üì¶ Folder Review Batch 1

_Last updated: 2024-01-15 14:30_

## Code Organization
[Claude's analysis of code structure...]

## Bug Patterns
[Identified potential issues...]

## Architecture Weaknesses
[Structural concerns and recommendations...]
```