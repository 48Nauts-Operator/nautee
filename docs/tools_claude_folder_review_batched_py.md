<!-- Auto-generated by Claude on 2025-06-22 04:31 -->

# Claude Folder Review (Batched) Documentation

## Overview

This Python script provides an automated code review solution using Anthropic's Claude AI model. It recursively scans a folder for source code files, organizes them into token-limited batches, and generates comprehensive Markdown reviews for each batch.

## Purpose

- **Automated Code Review**: Leverages Claude AI to analyze source code and provide insights
- **Batch Processing**: Handles large codebases by splitting files into manageable chunks
- **Documentation Generation**: Creates structured Markdown reports for easy reading and sharing
- **Multi-language Support**: Reviews various programming languages and file types

## Key Features

- Recursive folder scanning with file type filtering
- Intelligent batching based on token limits (~10k tokens per batch)
- Test file exclusion to focus on production code
- Structured Markdown output with timestamps
- Error handling and progress tracking

## Important Functions

### `is_excluded(filename: str) -> bool`

Filters out test files from the review process.

**Parameters:**
- `filename`: Path to the file being evaluated

**Returns:**
- `True` if the file should be excluded (test files), `False` otherwise

**Logic:**
- Checks for "test" keyword in filename or path
- Case-insensitive matching
- Supports both Unix and Windows path separators

### `estimate_tokens(text: str) -> int`

Provides a rough estimate of token count for batching purposes.

**Parameters:**
- `text`: Source code content

**Returns:**
- Estimated token count (assumes ~4 characters per token)

**Note:** This is a simplified estimation. For production use, consider using a proper tokenizer.

### `main()`

The primary orchestration function that handles the entire workflow:

1. **Setup Phase**
   - Loads environment variables
   - Initializes Anthropic client
   - Sets up output directory

2. **File Discovery**
   - Recursively scans the target folder
   - Filters by supported file extensions
   - Excludes test files

3. **Batching Logic**
   - Groups files into ~10k token batches
   - Prevents individual requests from exceeding API limits

4. **Review Generation**
   - Sends batches to Claude for analysis
   - Saves individual Markdown reports
   - Tracks progress and timing

## Configuration

### Environment Variables

```bash
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
```

### Supported File Types

```python
valid_exts = (
    ".py", ".js", ".ts", ".tsx", ".jsx", 
    ".html", ".css", ".json", ".go", 
    ".java", ".yaml", ".yml"
)
```

## Usage

### Basic Usage
```bash
python claude_folder_review.py /path/to/your/codebase
```

### Default Folder
```bash
python claude_folder_review.py  # Uses "../137docs" as default
```

## Output Structure

The script generates files in the following format:

```
docs/folder_review/
├── folder_review_batch_01.md
├── folder_review_batch_02.md
└── ...
```

Each batch file contains:
- Batch number and timestamp
- Detailed code analysis
- Architecture insights
- Improvement suggestions

## Review Focus Areas

Claude analyzes the code for:

- **Code Organization**: Structure and modularity assessment
- **Bug Patterns**: Common anti-patterns and potential issues  
- **Architecture Weaknesses**: Design flaws and scalability concerns
- **Improvement Suggestions**: Specific recommendations for enhancement

## Error Handling

- **File Reading Errors**: Individual file failures don't stop the entire process
- **API Errors**: Batch failures are logged but don't halt subsequent batches
- **Missing Files**: Graceful handling when no valid files are found

## Performance Considerations

- **Token Limits**: 10k token batches prevent API limit issues
- **Rate Limiting**: Consider adding delays between requests for large codebases
- **Memory Usage**: Files are processed individually to minimize memory footprint

## Suggestions for Enhancement

### Short-term Improvements
- Add configurable file extension filtering
- Implement proper tokenization instead of character-based estimation
- Add support for custom exclusion patterns via configuration file

### Long-term Enhancements
- **Parallel Processing**: Implement concurrent batch processing
- **Incremental Reviews**: Only review changed files since last run
- **Integration Support**: Add CI/CD pipeline integration
- **Custom Prompts**: Allow user-defined review criteria and focus areas
- **Report Aggregation**: Generate summary reports across all batches

### Configuration Options
Consider adding command-line arguments for:
- Custom output directory
- Token limit configuration  
- File extension customization
- Exclusion pattern specification

## Dependencies

```python
anthropic      # Claude AI API client
python-dotenv  # Environment variable management
```

## Notes

- Ensure your Anthropic API key has sufficient credits for batch processing
- Large codebases may generate significant API costs
- Review outputs are timestamped for version tracking
- The script creates output directories automatically