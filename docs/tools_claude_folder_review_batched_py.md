<!-- Auto-generated by Claude on 2025-06-22 22:18 -->

# Claude Folder Review (Batched) Documentation

## Overview

This Python script provides an automated code review solution that recursively analyzes source code files in a folder using Anthropic's Claude AI model. The script intelligently batches files to stay within token limits and generates detailed markdown reviews for each batch.

## Purpose

- **Automated Code Review**: Leverage Claude AI to perform comprehensive code reviews on entire codebases
- **Batch Processing**: Handle large codebases by splitting files into manageable chunks (~10k tokens each)
- **Documentation Generation**: Create organized markdown reports with insights and recommendations
- **Multi-language Support**: Review various file types including Python, JavaScript, TypeScript, Go, Java, and more

## Key Features

- ‚úÖ Recursive folder scanning
- ‚úÖ Token estimation and intelligent batching
- ‚úÖ Test file exclusion
- ‚úÖ Multi-format support
- ‚úÖ Error handling and progress tracking
- ‚úÖ Timestamped output files

## Functions

### `is_excluded(filename: str) -> bool`

Determines whether a file should be excluded from the review process.

**Parameters:**
- `filename` (str): The file path to check

**Returns:**
- `bool`: True if the file should be excluded (test files), False otherwise

**Exclusion Criteria:**
- Files containing "test" in the name (case-insensitive)
- Files starting with "test_"
- Files in directories containing "test"

```python
# Examples of excluded files:
# - test_utils.py
# - /tests/helper.js
# - unit_test.go
```

### `estimate_tokens(text: str) -> int`

Provides a rough estimation of token count for API rate limiting.

**Parameters:**
- `text` (str): Source code content

**Returns:**
- `int`: Estimated token count (uses 4 characters ‚âà 1 token ratio)

**Note:** This is a simplified estimation. For production use, consider using a proper tokenizer library.

### `main()`

The primary function that orchestrates the entire review process.

**Process Flow:**
1. **Setup**: Load environment variables and initialize Claude client
2. **File Discovery**: Scan folder for valid source files
3. **Token Batching**: Group files into batches under token limit
4. **AI Review**: Send batches to Claude for analysis
5. **Output Generation**: Save markdown reviews to disk

## Configuration

### Environment Variables

Create a `.env` file with the following variables:

```bash
ANTHROPIC_API_KEY=your_claude_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

### Supported File Extensions

The script processes files with these extensions:

- **Python**: `.py`
- **JavaScript/TypeScript**: `.js`, `.ts`, `.tsx`, `.jsx`
- **Web**: `.html`, `.css`
- **Data**: `.json`, `.yaml`, `.yml`
- **Other Languages**: `.go`, `.java`

## Usage

### Basic Usage

```bash
python claude_folder_review.py /path/to/your/codebase
```

### Default Behavior

If no folder is specified, it defaults to `../137docs`:

```bash
python claude_folder_review.py
```

## Output

The script generates markdown files in the `docs/folder_review/` directory:

```
docs/folder_review/
‚îú‚îÄ‚îÄ folder_review_batch_01.md
‚îú‚îÄ‚îÄ folder_review_batch_02.md
‚îî‚îÄ‚îÄ folder_review_batch_03.md
```

Each file contains:
- Batch number and timestamp
- Code organization analysis
- Bug pattern identification
- Architecture recommendations
- Modularization suggestions

## Dependencies

Install required packages:

```bash
pip install anthropic python-dotenv
```

## Recommendations & Best Practices

### üîß Performance Optimization

- **Token Limit**: The 10k token limit balances API efficiency with comprehensive analysis
- **Batch Size**: Adjust `MAX_TOKENS` based on your needs and API rate limits
- **File Filtering**: Consider adding more exclusion patterns for generated files, dependencies, etc.

### üõ°Ô∏è Error Handling

- The script continues processing even if individual files fail to read
- API errors are logged but don't stop the entire process
- Consider adding retry logic for transient API failures

### üìà Potential Enhancements

1. **Progress Bar**: Add `tqdm` for better progress visualization
2. **Parallel Processing**: Implement concurrent API calls (respecting rate limits)
3. **Custom Prompts**: Allow prompt customization via config files
4. **Report Aggregation**: Generate a summary report across all batches
5. **Git Integration**: Only review changed files since last commit

### ‚ö†Ô∏è Limitations

- **Token Estimation**: Uses simplified character-based estimation
- **File Size**: Very large individual files might exceed token limits
- **API Costs**: Be mindful of API usage costs for large codebases
- **Language Detection**: Relies on file extensions rather than content analysis

## Example Output Structure

```markdown
# üì¶ Folder Review Batch 1

_Last updated: 2024-01-15 14:30_

## Code Organization
- Well-structured module separation
- Clear naming conventions

## Bug Patterns
- Missing error handling in database connections
- Potential memory leaks in file operations

## Architecture Recommendations
- Consider implementing dependency injection
- Add logging framework integration
```