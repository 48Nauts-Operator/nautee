<!-- Auto-generated by Claude on 2025-06-23 03:26 -->

# Claude Folder Review (Batched) - Documentation

## Overview

This Python script automates the process of reviewing source code files using Claude AI. It recursively scans a folder for source code files, splits them into manageable batches based on token limits, and generates comprehensive code reviews in Markdown format.

## Purpose

- **Automated Code Review**: Leverages Claude AI to provide senior-level code review insights
- **Batch Processing**: Handles large codebases by splitting files into ~10k token chunks
- **Documentation Generation**: Outputs structured Markdown reviews for easy reading and sharing
- **Multi-language Support**: Reviews various programming languages and configuration files

## Key Features

- Recursive folder scanning with file filtering
- Token-based batching to stay within API limits  
- Exclusion of test files to focus on main codebase
- Timestamped output files for tracking review history
- Error handling for file reading and API calls

## Functions

### `is_excluded(filename: str) -> bool`

Filters out test files from the review process.

**Parameters:**
- `filename`: Full path or name of the file to check

**Returns:**
- `True` if the file should be excluded (contains "test" patterns)
- `False` if the file should be included in the review

**Logic:**
- Checks for "test" in filename (case-insensitive)
- Looks for "test_" prefix
- Detects "/test" or "\\test" in path

### `estimate_tokens(text: str) -> int`

Provides a rough estimate of token count for API usage planning.

**Parameters:**
- `text`: Source code content as string

**Returns:**
- Estimated token count (assumes ~4 characters per token)

**Note:** This is a simplified estimation. For production use, consider using more accurate tokenization libraries.

### `main()`

The primary function that orchestrates the entire review process.

**Process Flow:**
1. **Setup**: Loads environment variables and initializes Claude client
2. **File Discovery**: Recursively finds valid source files
3. **Token Batching**: Groups files to stay under token limits
4. **API Processing**: Sends batches to Claude for review
5. **Output Generation**: Saves Markdown reviews to disk

## Configuration

### Environment Variables

Create a `.env` file with the following variables:

```env
ANTHROPIC_API_KEY=your_claude_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514
```

### Supported File Types

The script processes files with these extensions:
- **Python**: `.py`
- **JavaScript/TypeScript**: `.js`, `.ts`, `.tsx`, `.jsx`
- **Web**: `.html`, `.css`
- **Data**: `.json`, `.yaml`, `.yml`
- **Other**: `.go`, `.java`

## Usage

### Basic Usage
```bash
python claude_folder_review.py
```
*Reviews the default folder: `../137docs`*

### Custom Folder
```bash
python claude_folder_review.py /path/to/your/codebase
```

### Output Structure
```
docs/folder_review/
‚îú‚îÄ‚îÄ folder_review_batch_01.md
‚îú‚îÄ‚îÄ folder_review_batch_02.md
‚îî‚îÄ‚îÄ folder_review_batch_03.md
```

## Review Focus Areas

The generated reviews concentrate on:
- **Code Organization**: Structure and modularity assessment
- **Bug Patterns**: Common error-prone code patterns
- **Architecture Weaknesses**: Design and scalability issues  
- **Improvement Suggestions**: Specific recommendations for enhancement

## Dependencies

```bash
pip install anthropic python-dotenv
```

## Notes and Suggestions

### ‚ö†Ô∏è Important Considerations

- **API Costs**: Each batch consumes Claude API tokens - monitor usage for large codebases
- **Rate Limits**: The script doesn't implement rate limiting - add delays for very large projects
- **Token Estimation**: The current estimation is simplified and may not be perfectly accurate

### üîß Potential Improvements

1. **Enhanced Token Counting**: Integrate with `tiktoken` or similar libraries for accurate token counting
2. **Progress Indicators**: Add progress bars for long-running reviews
3. **Configurable Exclusions**: Make file exclusion patterns configurable via command line or config file
4. **Resume Capability**: Add ability to resume interrupted batch processing
5. **Summary Generation**: Create an overall summary combining insights from all batches

### üí° Usage Tips

- Run on smaller folders first to understand output format and API costs
- Review the generated Markdown files in your preferred editor or documentation system
- Consider running reviews periodically as your codebase evolves
- Use the timestamp information to track review history over time

## Error Handling

The script includes error handling for:
- Missing or unreadable files
- Claude API failures
- Environment setup issues

Errors are logged to console with descriptive emoji indicators for easy identification.