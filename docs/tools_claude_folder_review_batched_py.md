<!-- Auto-generated by Claude on 2025-05-31 21:34 -->

# Claude Folder Review (Batched) Documentation

## Overview

This Python script performs automated code review of entire folders using Claude AI. It intelligently batches source code files into manageable chunks and generates comprehensive markdown reviews for each batch.

## Purpose

- **Automated Code Review**: Leverages Claude AI to analyze source code files
- **Batch Processing**: Handles large codebases by splitting them into ~10k token chunks
- **Documentation Generation**: Creates structured markdown reports for each batch
- **Multi-language Support**: Reviews various file types including Python, JavaScript, TypeScript, and more

## Key Features

- Recursive folder scanning
- Intelligent token-based batching
- Test file exclusion
- Multi-format file support
- Error handling and progress tracking

## Functions

### `is_excluded(filename: str) -> bool`

Determines whether a file should be excluded from the review process.

**Parameters:**
- `filename` (str): The file path to check

**Returns:**
- `bool`: True if the file should be excluded (test files), False otherwise

**Logic:**
- Excludes files containing "test" in the name
- Excludes files starting with "test_"
- Excludes files in test directories

### `estimate_tokens(text: str) -> int`

Provides a rough estimate of token count for API usage planning.

**Parameters:**
- `text` (str): The source code content

**Returns:**
- `int`: Estimated token count (uses 4 characters per token approximation)

### `main()`

The primary function that orchestrates the entire review process.

**Process Flow:**
1. **Setup**: Loads environment variables and initializes Claude client
2. **File Discovery**: Recursively scans folder for valid source files
3. **Token Batching**: Groups files into batches under the token limit
4. **Review Generation**: Sends batches to Claude for analysis
5. **Output**: Saves markdown reviews to the output directory

## Configuration

### Environment Variables

```bash
ANTHROPIC_API_KEY=your_claude_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
```

### Supported File Extensions

```python
valid_exts = (
    ".py", ".js", ".ts", ".tsx", ".jsx", 
    ".html", ".css", ".json", ".go", 
    ".java", ".yaml", ".yml"
)
```

### Default Settings

- **Token Limit**: 10,000 tokens per batch
- **Default Folder**: `../137docs`
- **Output Directory**: `docs/folder_review/`
- **Model**: `claude-sonnet-4-20250514`

## Usage

### Basic Usage
```bash
python claude_folder_review.py
```

### Custom Folder
```bash
python claude_folder_review.py /path/to/your/codebase
```

## Output Format

The script generates numbered markdown files:
```
docs/folder_review/
‚îú‚îÄ‚îÄ folder_review_batch_01.md
‚îú‚îÄ‚îÄ folder_review_batch_02.md
‚îî‚îÄ‚îÄ folder_review_batch_03.md
```

Each file contains:
- Batch number header
- Timestamp
- Claude's analysis focusing on:
  - Code organization
  - Bug patterns
  - Architecture weaknesses
  - Modularization suggestions

## Dependencies

```python
pip install anthropic python-dotenv
```

## Error Handling

- **File Reading Errors**: Continues processing other files if individual files fail
- **API Errors**: Reports Claude API issues but continues with remaining batches
- **Missing Files**: Exits gracefully if no valid files are found

## Notes and Suggestions

### ‚ö†Ô∏è Important Considerations

- **API Costs**: Each batch makes a Claude API call - monitor usage for large codebases
- **Token Estimation**: The 4-character-per-token estimation is approximate
- **Rate Limits**: Consider adding delays between API calls for very large batches

### üîß Potential Improvements

1. **Add Progress Bar**: For better user experience during long reviews
2. **Configurable Exclusions**: Allow custom exclusion patterns via config file
3. **Resume Capability**: Skip already processed batches
4. **Summary Report**: Generate an overall summary combining all batch insights
5. **Language Detection**: More sophisticated file type detection beyond extensions

### üí° Usage Tips

- Run on clean, committed code to get the most relevant feedback
- Review the generated markdown files to identify patterns across batches
- Use the batch structure to focus reviews on specific parts of your codebase
- Consider running periodically as part of your development workflow

## Example Output Structure

```markdown
# üì¶ Folder Review Batch 1

_Last updated: 2024-01-15 14:30_

## Code Organization
- Well-structured module hierarchy
- Clear separation of concerns

## Bug Patterns
- Missing error handling in file I/O operations
- Potential race conditions in async code

## Architecture Weaknesses
- Tight coupling between data and presentation layers
- Missing abstraction for external API calls

## Suggestions
- Implement proper logging framework
- Add unit tests for core business logic
```