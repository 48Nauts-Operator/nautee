<!-- Auto-generated by Claude on 2025-06-08 07:18 -->

# Claude Folder Review (Batched) Documentation

## Overview

This script performs automated code reviews of entire source code folders using Claude AI. It intelligently batches files to stay within token limits and generates comprehensive markdown reports for each batch.

## Purpose

- **Automated Code Review**: Reviews multiple source files simultaneously using Claude AI
- **Batch Processing**: Splits large codebases into manageable chunks (~10k tokens each)
- **Documentation Generation**: Creates structured markdown reports for analysis
- **Multi-language Support**: Handles various programming languages and file types

## Key Features

### Token Management
- Estimates token usage to prevent API limits
- Automatically batches files when approaching the 10,000 token threshold
- Processes each batch separately for optimal performance

### File Filtering
- Excludes test files automatically
- Supports multiple programming languages
- Recursively scans directories

### Output Organization
- Creates timestamped markdown reports
- Organizes reviews by batch number
- Stores all outputs in a structured directory

## Functions

### `is_excluded(filename: str) -> bool`

Determines whether a file should be excluded from review.

**Parameters:**
- `filename`: Path to the file being evaluated

**Returns:**
- `bool`: `True` if the file should be excluded (test files), `False` otherwise

**Logic:**
- Excludes files containing "test" in the name or path
- Case-insensitive matching
- Handles both Unix and Windows path separators

```python
# Examples of excluded files:
# - test_utils.py
# - /tests/unit.py  
# - component.test.js
```

### `estimate_tokens(text: str) -> int`

Provides a rough estimate of token count for API planning.

**Parameters:**
- `text`: Source code content

**Returns:**
- `int`: Estimated token count (uses 4 characters ‚âà 1 token approximation)

**Note:** This is a simplified estimation. Actual token counts may vary depending on the content structure.

## Configuration

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `ANTHROPIC_API_KEY` | Claude API key (required) | None |
| `ANTHROPIC_MODEL` | Claude model to use | `claude-sonnet-4-20250514` |

### Supported File Extensions

```python
valid_exts = (".py", ".js", ".ts", ".tsx", ".jsx", ".html", 
              ".css", ".json", ".go", ".java", ".yaml", ".yml")
```

### Batch Configuration

- **Maximum tokens per batch**: 10,000
- **Maximum response tokens**: 2,000
- **Output directory**: `docs/folder_review/`

## Usage

### Basic Usage
```bash
python claude_folder_review.py /path/to/source/folder
```

### Default Behavior
```bash
python claude_folder_review.py
# Reviews "../137docs" folder by default
```

## Output Structure

The script generates numbered markdown files in the `docs/folder_review/` directory:

```
docs/folder_review/
‚îú‚îÄ‚îÄ folder_review_batch_01.md
‚îú‚îÄ‚îÄ folder_review_batch_02.md
‚îî‚îÄ‚îÄ folder_review_batch_03.md
```

### Output Format

Each batch file contains:
- Header with batch number
- Timestamp of generation
- Detailed code review focusing on:
  - Code organization
  - Bug patterns  
  - Architecture weaknesses
  - Modularization suggestions

## Dependencies

```python
# Required packages
anthropic      # Claude AI API client
python-dotenv  # Environment variable management
```

## Error Handling

The script includes robust error handling for:
- **File Reading Errors**: Logs issues but continues processing
- **API Errors**: Reports Claude API failures per batch
- **Missing Files**: Exits gracefully if no valid files found

## Performance Notes

- **Timing**: Displays total execution time upon completion
- **Progress Tracking**: Shows current batch being processed
- **Memory Efficient**: Processes files in batches rather than loading everything

## Suggestions for Improvement

### üîß Potential Enhancements

1. **Token Estimation**: Consider using tiktoken for more accurate token counting
2. **Configuration File**: Add support for custom file extensions and exclusion patterns
3. **Parallel Processing**: Implement concurrent batch processing for faster execution
4. **Resume Capability**: Add ability to resume interrupted reviews
5. **Summary Report**: Generate an overall summary combining all batch insights

### ‚ö†Ô∏è Important Notes

- **API Costs**: Be mindful of Claude API usage costs with large codebases
- **Rate Limiting**: The script doesn't implement rate limiting - consider adding delays for large batches
- **File Encoding**: Assumes UTF-8 encoding for all source files
- **Security**: Ensure your API key is properly secured and not committed to version control