<!-- Auto-generated by Claude on 2025-06-01 20:21 -->

# Claude Folder Review (Batched) Documentation

## Overview

This Python script provides an automated code review solution that uses Anthropic's Claude AI to analyze source code files in batches. The tool recursively scans a directory, groups files into token-optimized batches, and generates comprehensive Markdown reviews for each batch.

## Purpose

- **Automated Code Review**: Leverage Claude AI to perform intelligent code analysis
- **Batch Processing**: Handle large codebases by splitting files into manageable chunks
- **Documentation Generation**: Create structured Markdown reports for review insights
- **Multi-language Support**: Process various file types including Python, JavaScript, TypeScript, and more

## Key Features

- **Token Management**: Automatically estimates and manages token limits (~10k per batch)
- **File Filtering**: Excludes test files and supports multiple programming languages
- **Error Handling**: Graceful handling of file read errors and API failures
- **Progress Tracking**: Real-time feedback on processing status

## Functions

### `is_excluded(filename: str) -> bool`

Determines whether a file should be excluded from analysis based on naming patterns.

**Parameters:**
- `filename` (str): The file path to evaluate

**Returns:**
- `bool`: True if the file should be excluded (test files), False otherwise

**Exclusion Criteria:**
- Files containing "test" in the name
- Files starting with "test_"
- Files in test directories

### `estimate_tokens(text: str) -> int`

Provides a rough estimation of token count for API usage planning.

**Parameters:**
- `text` (str): The source code content

**Returns:**
- `int`: Estimated token count (uses 4 characters per token approximation)

### `main()`

The primary execution function that orchestrates the entire review process.

**Key Steps:**
1. **Environment Setup**: Loads API credentials and configuration
2. **File Discovery**: Scans directory for valid source files
3. **Token Batching**: Groups files to stay within API limits
4. **AI Processing**: Sends batches to Claude for analysis
5. **Report Generation**: Saves Markdown reviews to disk

## Configuration

### Environment Variables

```bash
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, defaults to this model
```

### Supported File Extensions

- **Python**: `.py`
- **JavaScript/TypeScript**: `.js`, `.ts`, `.tsx`, `.jsx`
- **Web**: `.html`, `.css`
- **Data**: `.json`, `.yaml`, `.yml`
- **Other**: `.go`, `.java`

## Usage

### Basic Usage

```bash
python claude_folder_review.py /path/to/your/code
```

### Default Behavior

```bash
python claude_folder_review.py
# Uses default folder: "../137docs"
```

## Output Structure

The script generates organized output in the `docs/folder_review/` directory:

```
docs/folder_review/
├── folder_review_batch_01.md
├── folder_review_batch_02.md
└── folder_review_batch_03.md
```

Each batch file contains:
- Batch number and timestamp
- Structured code analysis
- Architecture recommendations
- Bug pattern identification
- Modularization suggestions

## Review Focus Areas

Claude analyzes code with emphasis on:

- **Code Organization**: Structure and modularity assessment
- **Bug Patterns**: Common error-prone patterns
- **Architecture Weaknesses**: Design flaws and improvements
- **Clarity Suggestions**: Readability and maintainability enhancements

## Technical Specifications

- **Token Limit**: 10,000 tokens per batch
- **API Response Limit**: 2,000 tokens per response
- **Default Model**: Claude Sonnet 4 (2025-05-14)
- **Output Format**: Markdown with structured headings

## Error Handling

The script includes robust error handling for:

- **File Access Errors**: Continues processing when individual files can't be read
- **API Failures**: Reports errors but continues with remaining batches
- **Missing Dependencies**: Clear error messages for setup issues

## Dependencies

```python
import os
import sys
import anthropic
from dotenv import load_dotenv
from datetime import datetime
import time
```

**Required Packages:**
- `anthropic` - Claude AI API client
- `python-dotenv` - Environment variable management

## Notes and Suggestions

### Performance Considerations

- **Large Codebases**: Processing time scales with codebase size
- **API Rate Limits**: Consider adding delays between requests for very large projects
- **Token Estimation**: The 4:1 character-to-token ratio is approximate

### Customization Options

- **File Extensions**: Modify `valid_exts` tuple to support additional languages
- **Token Limits**: Adjust `MAX_TOKENS` based on your needs
- **Review Focus**: Customize the Claude prompt for specific analysis requirements

### Best Practices

- **API Key Security**: Store credentials in `.env` file, never in code
- **Output Management**: Regularly clean old review files to save disk space
- **Incremental Reviews**: Consider running on changed files only for large projects

### Potential Improvements

- Add support for `.gitignore` pattern exclusions
- Implement caching to avoid re-reviewing unchanged files
- Add configuration file support for custom settings
- Include file modification timestamps in reviews