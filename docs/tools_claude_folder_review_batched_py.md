<!-- Auto-generated by Claude on 2025-06-02 06:31 -->

# Claude Folder Review (Batched) Documentation

## Overview

This script provides an automated code review solution that analyzes source code files in a directory using Anthropic's Claude AI. It intelligently batches files to stay within token limits and generates comprehensive Markdown documentation for each batch.

## Purpose

- **Automated Code Review**: Leverages Claude AI to perform intelligent code analysis
- **Batch Processing**: Handles large codebases by splitting files into manageable chunks
- **Documentation Generation**: Creates structured Markdown reports for review insights
- **Multi-language Support**: Reviews various file types including Python, JavaScript, TypeScript, and more

## Key Features

- Recursive directory scanning
- Token-aware batching (~10k tokens per batch)
- Test file exclusion
- Multiple programming language support
- Structured Markdown output with timestamps

## Functions

### `is_excluded(filename: str) -> bool`

Determines whether a file should be excluded from the review process.

**Parameters:**
- `filename` (str): The file path to evaluate

**Returns:**
- `bool`: True if the file should be excluded (test files), False otherwise

**Logic:**
- Excludes files containing "test" in the name or path
- Case-insensitive matching
- Handles both Unix and Windows path separators

### `estimate_tokens(text: str) -> int`

Provides a rough estimate of token count for API usage planning.

**Parameters:**
- `text` (str): The source code content

**Returns:**
- `int`: Estimated token count (character count ÷ 4)

**Note:** This is a simplified estimation. For production use, consider using a proper tokenizer.

### `main()`

The primary execution function that orchestrates the entire review process.

**Process Flow:**
1. **Setup**: Loads environment variables and initializes Claude client
2. **File Discovery**: Recursively scans directory for valid source files
3. **Token Batching**: Groups files to stay within API limits
4. **Review Generation**: Sends batches to Claude and saves responses

## Configuration

### Environment Variables

```bash
ANTHROPIC_API_KEY=your_api_key_here
ANTHROPIC_MODEL=claude-sonnet-4-20250514  # Optional, has default
```

### Supported File Extensions

- Python: `.py`
- JavaScript/TypeScript: `.js`, `.ts`, `.tsx`, `.jsx`
- Web: `.html`, `.css`
- Configuration: `.json`, `.yaml`, `.yml`
- Other: `.go`, `.java`

## Usage

### Basic Usage
```bash
python script.py
```
*Reviews the default `../137docs` directory*

### Custom Directory
```bash
python script.py /path/to/your/codebase
```

### Output Structure
```
docs/folder_review/
├── folder_review_batch_01.md
├── folder_review_batch_02.md
└── folder_review_batch_03.md
```

## Review Focus Areas

The Claude AI analyzes code for:
- **Code Organization**: Structure and maintainability
- **Bug Patterns**: Common error-prone constructs
- **Architecture Weaknesses**: Design issues and anti-patterns
- **Modularization**: Suggestions for better code organization

## Notes and Recommendations

### ⚠️ Important Considerations

- **API Costs**: Each batch consumes Claude API tokens - monitor usage for large codebases
- **Rate Limits**: The script doesn't implement rate limiting - consider adding delays for large projects
- **Token Estimation**: The current estimation method is basic; consider integrating a proper tokenizer
- **Error Handling**: File reading errors are logged but don't stop processing

### 🔧 Potential Improvements

1. **Enhanced Token Counting**: Use tiktoken or similar for accurate token estimation
2. **Rate Limiting**: Add configurable delays between API calls
3. **Resume Capability**: Allow resuming interrupted batch processing
4. **Custom Exclusions**: Support for `.gitignore`-style exclusion patterns
5. **Output Formats**: Support for additional output formats (HTML, PDF)
6. **Progress Tracking**: Add progress bars for better user experience

### 💡 Usage Tips

- Start with smaller directories to test API configuration
- Review the generated output directory structure before processing large codebases
- Consider running during off-peak hours to minimize API costs
- Keep your `.env` file secure and never commit API keys to version control

## Dependencies

```python
anthropic>=0.3.0
python-dotenv>=0.19.0
```

Install with:
```bash
pip install anthropic python-dotenv
```